<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SPS DApp - Ù†Ø³Ø®Ù‡ Ù†Ù‡Ø§ÛŒÛŒ (FA/EN)</title>

    <!-- ETHER.JS Ø­Ø°Ù Ø´Ø¯Ù‡ Ø§Ø² CDN - Ø¯Ø±ÙˆÙ† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯ -->
    
    <style>
        /* ====== Variables ====== */
        :root{
            --primary: #3b82f6;
            --accent: #8b5cf6;
            --neon: #00ffd5;
            --bg-1: #05060a;
            --card-bg: rgba(8,12,22,0.7);
            --muted: #94a3b8;
            --success: #10b981;
            --danger: #ef4444;
        }
        *{box-sizing:border-box;margin:0;padding:0}
        html[dir="rtl"]{ direction: rtl; }
        html[dir="ltr"]{ direction: ltr; }

        body{
            font-family: Tahoma, Arial, sans-serif;
            background: radial-gradient(1200px 600px at 10% 10%, rgba(139,92,246,0.08), transparent),
                        radial-gradient(1000px 500px at 90% 90%, rgba(59,130,246,0.04), transparent),
                        linear-gradient(180deg,#030416 0%, #081028 100%);
            color: #e6eef8;
            min-height:100vh;
            padding:20px;
            position: relative;
            overflow-x: hidden;
        }

        /* === Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…ØªØ­Ø±Ú© AI === */
        .ai-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
        }

        .ai-particle {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--neon) 0%, transparent 70%);
            filter: blur(10px);
            opacity: 0.4;
            animation: ai-float 15s infinite linear;
        }

        .ai-trail {
            position: absolute;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(59,130,246,0.1) 0%, transparent 70%);
            filter: blur(30px);
            animation: ai-trail-rotate 20s infinite linear;
        }

        @keyframes ai-float {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0.3; }
            25% { transform: translate(100px, 50px) rotate(90deg); opacity: 0.6; }
            50% { transform: translate(200px, -30px) rotate(180deg); opacity: 0.3; }
            75% { transform: translate(50px, 100px) rotate(270deg); opacity: 0.6; }
            100% { transform: translate(0, 0) rotate(360deg); opacity: 0.3; }
        }

        @keyframes ai-trail-rotate {
            0% { transform: rotate(0deg); opacity: 0.1; }
            100% { transform: rotate(360deg); opacity: 0.3; }
        }

        .container{ max-width:1200px; margin:0 auto; position:relative; }

        /* === Ù„ÙˆÚ¯ÙˆÛŒ SPS Ù…ØªØ­Ø±Ú© === */
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
        }

        .logo-animated {
            font-weight: 900;
            font-size: 24px;
            background: linear-gradient(90deg, var(--primary), var(--accent), var(--neon));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 
                0 0 20px rgba(59,130,246,0.5),
                0 0 40px rgba(139,92,246,0.3),
                0 0 60px rgba(0,255,213,0.2);
            animation: logo-pulse 2s infinite alternate,
                     logo-rotate 10s infinite linear;
            padding: 8px 16px;
            border-radius: 12px;
            position: relative;
            display: inline-block;
            transform-style: preserve-3d;
            perspective: 500px;
        }

        .logo-animated::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(90deg, var(--primary), var(--accent), var(--neon));
            border-radius: 14px;
            filter: blur(10px);
            opacity: 0.5;
            z-index: -1;
            animation: logo-glow 3s infinite alternate;
        }

        @keyframes logo-pulse {
            0% { transform: scale(1) translateZ(0); }
            100% { transform: scale(1.05) translateZ(20px); }
        }

        @keyframes logo-rotate {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        @keyframes logo-glow {
            0% { opacity: 0.3; filter: blur(5px); }
            100% { opacity: 0.7; filter: blur(15px); }
        }

        /* flashy header gradient animation */
        .header{
            display:flex; align-items:center; justify-content:space-between; gap:12px;
            background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border-radius:12px; padding:14px; border:1px solid rgba(255,255,255,0.03);
            box-shadow: 0 6px 30px rgba(59,130,246,0.06);
            position:relative; overflow:hidden;
        }
        .header:before{
            content:""; position:absolute; inset:-50% -30%; background:linear-gradient(120deg, rgba(59,130,246,0.05), rgba(139,92,246,0.06), rgba(0,255,213,0.02));
            transform:rotate(25deg); animation:slow-slide 10s linear infinite;
        }
        @keyframes slow-slide { from{transform:rotate(25deg) translateX(-10%)} to{transform:rotate(25deg) translateX(10%)} }

        .status-ind{ display:flex; gap:10px; align-items:center }
        .status-dot{ width:12px; height:12px; border-radius:50%; background:var(--danger); box-shadow:0 0 10px rgba(239,68,68,0.3) }
        .status-dot.connected{ background:var(--success); box-shadow:0 0 14px rgba(16,185,129,0.3) }
        .network-text{ font-weight:700; color:var(--muted) }

        /* language toggle */
        .lang-switch{ display:flex; gap:8px; align-items:center }
        .lang-btn{ padding:8px 10px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); cursor:pointer; background:transparent; color:var(--muted); font-weight:700 }
        .lang-btn.active{ background:linear-gradient(90deg,var(--primary),var(--accent)); color:#081226; box-shadow:0 8px 26px rgba(59,130,246,0.18) }

        /* tabs */
        .tabs{ display:flex; gap:8px; margin:16px 0; flex-wrap:wrap }
        .tab-btn{ padding:10px 12px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.02); color:var(--muted); cursor:pointer; font-weight:700 }
        .tab-btn.active{ background:linear-gradient(90deg, rgba(59,130,246,0.14), rgba(139,92,246,0.08)); color:var(--primary); box-shadow:0 10px 30px rgba(59,130,246,0.06) }

        /* stats grid */
        .stats-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:14px; margin:14px 0 }
        .stat-box{
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            padding:14px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);
            position:relative; overflow:hidden;
        }
        /* neon number pulse */
        .stat-value{ font-weight:900; font-size:18px; color:#cfe7ff; text-shadow:0 0 12px rgba(59,130,246,0.12) }
        .stat-label{ color:var(--muted); font-size:13px }

        /* glowing accent */
        .glow-accent{ position:absolute; right:-60px; top:-40px; width:180px; height:180px; background: radial-gradient(circle at 30% 20%, rgba(59,130,246,0.18), transparent 30%), radial-gradient(circle at 70% 80%, rgba(139,92,246,0.12), transparent 20%); filter: blur(18px); transform:rotate(10deg); pointer-events:none }

        /* grid 2 */
        .grid-2{ display:grid; grid-template-columns:1fr 1fr; gap:18px; margin-top:12px }
        .card{ background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01)); padding:14px; border-radius:10px; border:1px solid rgba(255,255,255,0.03); position:relative; overflow:hidden }

        /* flashy animations: neon pulse */
        .neon-pulse{ animation:neon 2s ease-in-out infinite; }
        @keyframes neon { 0%{ box-shadow: 0 0 6px rgba(59,130,246,0.12)} 50%{ box-shadow: 0 0 18px rgba(59,130,246,0.22)} 100%{ box-shadow: 0 0 6px rgba(59,130,246,0.12)} }

        /* tree */
        .tree-container{ max-height:520px; overflow:auto; padding:10px; border-radius:8px; background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent) }
        .node{ 
            padding:12px; 
            border-radius:10px; 
            margin-bottom:10px; 
            background: linear-gradient(135deg, rgba(8,12,22,0.8), rgba(16,20,32,0.6));
            border:1px solid rgba(59,130,246,0.1);
            display:flex; 
            justify-content:space-between; 
            align-items:center; 
            gap:12px;
            transition: all 0.3s ease;
            position: relative;
        }
        .node:hover{ 
            transform: translateY(-6px) scale(1.02); 
            box-shadow: 0 12px 40px rgba(59,130,246,0.1);
            border-color: rgba(0,255,213,0.3);
        }
        
        .node-main {
            background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(139,92,246,0.1));
            border: 2px solid rgba(59,130,246,0.3);
        }
        
        .node-special {
            position: relative;
            border-left: 4px solid var(--neon);
        }
        
        .special-badge {
            background: linear-gradient(90deg, var(--neon), #00ccaa);
            color: #000;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .node-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex: 1;
        }
        
        .node-id {
            font-weight: 800;
            font-size: 16px;
            color: #cfe7ff;
        }
        
        .node-stats {
            display: flex;
            gap: 12px;
            font-size: 12px;
            color: var(--muted);
        }
        
        .meta{ color:var(--muted); font-size:13px; }

        .children{ margin-right:16px; padding-right:12px; border-right:2px dashed rgba(59,130,246,0.06) }
        .toggle-btn{ 
            background: linear-gradient(90deg, rgba(59,130,246,0.1), rgba(139,92,246,0.1));
            border:1px solid rgba(255,255,255,0.05); 
            padding:6px 12px; 
            border-radius:8px; 
            color:var(--primary); 
            cursor:pointer; 
            font-weight:700;
            transition: all 0.3s;
        }
        
        .toggle-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(59,130,246,0.2);
        }

        /* === Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø± === */
        .miner-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }
        
        .miner-stat {
            background: rgba(16,20,32,0.5);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(59,130,246,0.1);
        }
        
        .miner-stat-label {
            font-size: 11px;
            color: var(--muted);
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .miner-stat-value {
            font-size: 18px;
            font-weight: 800;
            color: #cfe7ff;
        }
        
        .miner-progress {
            margin-top: 15px;
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 4px;
            transition: width 1s ease;
        }

        /* forms */
        .form-group{ margin-bottom:12px }
        .form-label{ color:var(--muted); font-size:13px; margin-bottom:6px; display:block }
        input[type="text"], input[type="number"], select, textarea{ 
            width:100%; 
            padding:10px; 
            border-radius:8px; 
            border:1px solid rgba(255,255,255,0.04); 
            background:rgba(8,12,22,0.5); 
            color:inherit;
            transition: all 0.3s;
        }
        
        input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(59,130,246,0.2);
            outline: none;
        }

        /* buttons */
        .btn{ padding:12px; border-radius:8px; border:none; cursor:pointer; font-weight:800; transition: all 0.3s; }
        .btn-primary{ background:linear-gradient(90deg,var(--primary),var(--accent)); color:white; box-shadow:0 10px 30px rgba(59,130,246,0.08) }
        .btn-success{ background:linear-gradient(90deg,var(--success),#34d399); color:#02160f }
        .btn-warning{ background:linear-gradient(90deg,#f59e0b,#fbbf24); color:#2b1600 }
        .btn-danger{ background:linear-gradient(90deg,var(--danger),#f87171); color:#2b0e0e }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }

        .btn-group{ display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:10px }

        /* status */
        .status{ padding:12px; border-radius:8px; margin-top:10px; font-weight:800; text-align:center }
        .status.info{ background: rgba(59,130,246,0.06); color:#60a5fa; border:1px solid rgba(59,130,246,0.06) }
        .status.success{ background: rgba(16,185,129,0.06); color:#34d399; border:1px solid rgba(16,185,129,0.06) }
        .status.error{ background: rgba(239,68,68,0.06); color:#fb7185; border:1px solid rgba(239,68,68,0.06) }
        .tx-link{ color:#9ecbff; text-decoration:none; padding:6px 10px; display:inline-block; margin-top:8px; border-radius:6px; border:1px solid rgba(59,130,246,0.06) }

        /* countdown card (graphic) */
        .countdown{
            display:flex; align-items:center; gap:10px; justify-content:center; padding:12px; border-radius:12px;
            background:linear-gradient(90deg, rgba(59,130,246,0.06), rgba(139,92,246,0.04));
            border:1px solid rgba(255,255,255,0.03);
            box-shadow: 0 16px 40px rgba(139,92,246,0.06);
            font-weight:900;
        }
        .time-segment{ display:flex; flex-direction:column; align-items:center; padding:8px 10px; border-radius:8px; background:rgba(0,0,0,0.3) }
        .time-value{ font-size:18px; color:#cfe7ff; text-shadow:0 0 8px rgba(59,130,246,0.12) }
        .time-label{ font-size:12px; color:var(--muted) }

        /* loading overlay */
        .loading{ display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:9999; align-items:center; justify-content:center }
        .spinner{ width:76px; height:76px; border-radius:50%; border:6px solid rgba(255,255,255,0.06); border-top-color:var(--neon); animation:spin 1s linear infinite }
        @keyframes spin { to{ transform:rotate(360deg) } }

        footer{ margin-top:22px; text-align:center; color:var(--muted); font-size:13px }

        /* confetti canvas */
        #confetti { position:fixed; inset:0; pointer-events:none; z-index:10000; display:none }

        /* responsive */
        @media (max-width:900px){ .grid-2{ grid-template-columns:1fr } .header{ flex-direction:column; align-items:flex-start } }
        @media (max-width:600px){ .miner-details{ grid-template-columns:1fr } }
    </style>
</head>
<body>
    <!-- Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…ØªØ­Ø±Ú© AI -->
    <div class="ai-bg" id="aiBg"></div>
    
    <canvas id="confetti"></canvas>
    <div class="container">
        <!-- header -->
        <div class="header">
            <div style="display:flex;align-items:center;gap:12px">
                <div class="logo-container">
                    <div class="logo-animated">SPS</div>
                    <div class="status-ind">
                        <div id="statusDot" class="status-dot"></div>
                        <div id="networkStatus" class="network-text">Ø§ØªØµØ§Ù„ Ø´Ø¨Ú©Ù‡</div>
                    </div>
                </div>
            </div>

            <div style="display:flex;align-items:center;gap:12px">
                <div class="lang-switch" role="tablist" aria-label="Language switch">
                    <button id="btn-fa" class="lang-btn active" title="ÙØ§Ø±Ø³ÛŒ">FA</button>
                    <button id="btn-en" class="lang-btn" title="English">EN</button>
                </div>
                <div id="connectArea">
                    <button id="connectBtn" class="btn-primary btn">Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„</button>
                </div>
            </div>
        </div>

        <!-- tabs -->
        <div class="tabs" id="tabsRow">
            <button class="tab-btn active" onclick="showTab('dashboard')">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</button>
            <button class="tab-btn" onclick="showTab('register')">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
            <button class="tab-btn" onclick="showTab('miner')">Ù…Ø§ÛŒÙ†Ø±</button>
            <button class="tab-btn" onclick="showTab('actions')">Ø¹Ù…Ù„ÛŒØ§Øª</button>
            <button class="tab-btn" onclick="showTab('admin')" id="adminTab" style="display:none">Ù…Ø¯ÛŒØ±ÛŒØª</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboardTab">
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="glow-accent"></div>
                    <div class="stat-label" id="label-poolBalance">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ø³ØªØ®Ø±</div>
                    <div class="stat-value neon-pulse" id="poolBalance">0 MATIC</div>
                </div>

                <div class="stat-box">
                    <div class="stat-label" id="label-minerPool">Ø§Ø³ØªØ®Ø± Ù…Ø§ÛŒÙ†Ø±</div>
                    <div class="stat-value neon-pulse" id="minerPool">0 pToken</div>
                </div>

                <div class="stat-box">
                    <div class="stat-label" id="label-specialPool">Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡</div>
                    <div class="stat-value" id="specialPool">0 MATIC</div>
                </div>

                <div class="stat-box">
                    <div class="stat-label" id="label-entryFee">Ú©Ø§Ø±Ù…Ø²Ø¯ ÙˆØ±ÙˆØ¯</div>
                    <div class="stat-value" id="entryFeeDisplay">0 MATIC</div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h3 id="h-userinfo">ğŸ‘¤ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±ÛŒ</h3>
                    <div id="userInfo" class="status info">Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØµÙ„ Ù†ÛŒØ³Øª</div>
                    <div class="help" id="help-userinfo">Ù¾Ø³ Ø§Ø² Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ù„ÛŒÙ†Ú© ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.</div>

                    <div style="margin-top:12px">
                        <div id="lastPoolTimerCard" class="countdown" title="Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯Ø§Ø´Øª Ø¨Ø¹Ø¯ÛŒ Ø§Ø³ØªØ®Ø± Ø§ØµÙ„ÛŒ">
                            <div style="font-size:13px" id="lastPoolLabel">Ø§Ø®Ø±ÛŒÙ† Ø¨Ø±Ø¯Ø§Ø´Øª: -</div>
                            <div id="poolTimerSegments" style="display:flex;gap:6px;margin-left:12px"></div>
                        </div>

                        <div style="height:12px"></div>

                        <div id="specialWithdrawCard" class="countdown" title="Ø²Ù…Ø§Ù† ØªØ§ Ø¨Ø±Ø¯Ø§Ø´Øª Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡ (3rd UTC)">
                            <div style="font-weight:700;margin-right:12px" id="specialLabel">Ø¨Ø±Ø¯Ø§Ø´Øª ÙˆÛŒÚ˜Ù‡ Ø¨Ø¹Ø¯ÛŒ</div>
                            <div id="specialTimerSegments" style="display:flex;gap:6px"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 id="h-tree">ğŸŒ³ Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø±Ø®ØªÛŒ Ø´Ù…Ø§</h3>
                    <div class="tree-container" id="treeContainer">
                        <div class="node node-main">ğŸ”„ Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯</div>
                    </div>
                    <div class="help" id="help-tree">Ø±ÙˆÛŒ Ù‡Ø± Ú¯Ø±Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù† ØªØ§ Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ Ø¨Ø§Ø²/Ø¨Ø³ØªÙ‡ Ø´ÙˆÙ†Ø¯ â€” ØªØ¹Ø¯Ø§Ø¯ Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ Ú©Ù†Ø§Ø± Ù‡Ø± Ú¯Ø±Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</div>
                </div>
            </div>
        </div>

        <!-- Register -->
        <div id="registerTab" style="display:none">
            <div class="grid-2">
                <div class="card">
                    <h3 id="h-register">ğŸ“ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h3>
                    <div class="form-group">
                        <label class="form-label" id="label-upline">Ú©Ø¯ Ø¢Ù¾Ù„Ø§ÛŒÙ†</label>
                        <input id="uplineCode" class="form-input" type="number" placeholder="1" />
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="label-position">Ù…ÙˆÙ‚Ø¹ÛŒØª</label>
                        <select id="position" class="form-input">
                            <option value="true">Ú†Ù¾</option>
                            <option value="false">Ø±Ø§Ø³Øª</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="register()" id="btn-register">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… (300 MATIC)</button>
                    <div id="registerResult"></div>
                </div>

                <div class="card">
                    <h3 id="h-reginfo">ğŸ“Š Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h3>
                    <div id="registerInfo" class="status info">Ù¾Ø³ Ø§Ø² Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</div>
                </div>
            </div>
        </div>

        <!-- Miner -->
        <div id="minerTab" style="display:none">
            <div class="grid-2">
                <div class="card">
                    <h3 id="h-miner">â›ï¸ Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø§ÛŒÙ†Ø±</h3>
                    <div class="form-group">
                        <label class="form-label" id="label-contribution">Ù…Ù‚Ø¯Ø§Ø± Ù…Ø´Ø§Ø±Ú©Øª (MATIC)</label>
                        <input id="contribution" class="form-input" placeholder="0.1" />
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-success" onclick="contribute()" id="btn-contrib">Ù…Ø´Ø§Ø±Ú©Øª</button>
                        <button class="btn btn-primary" onclick="buyTokens()" id="btn-buy">Ø®Ø±ÛŒØ¯ ØªÙˆÚ©Ù† Ù…Ø§ÛŒÙ†Ø±</button>
                        <button class="btn btn-success" onclick="distribute()" id="btn-distrib">ØªÙˆØ²ÛŒØ¹ ØªÙˆÚ©Ù†â€ŒÙ‡Ø§</button>
                    </div>

                    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø± -->
                    <div id="minerDetails" class="miner-details" style="display:none; margin-top:20px;">
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-tokenPrice">Ù‚ÛŒÙ…Øª ØªÙˆÚ©Ù†</div>
                            <div class="miner-stat-value" id="tokenPrice">- MATIC</div>
                        </div>
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-minerRewards">Ù¾Ø§Ø¯Ø§Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§ÛŒÙ†Ø±</div>
                            <div class="miner-stat-value" id="minerRewards">-</div>
                        </div>
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-isMiner">ÙˆØ¶Ø¹ÛŒØª Ù…Ø§ÛŒÙ†Ø±</div>
                            <div class="miner-stat-value" id="isMiner">-</div>
                        </div>
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-lastBuyTime">Ø¢Ø®Ø±ÛŒÙ† Ø®Ø±ÛŒØ¯</div>
                            <div class="miner-stat-value" id="lastBuyTime">-</div>
                        </div>
                    </div>

                    <div class="miner-progress" id="minerProgress" style="display:none">
                        <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                            <span id="label-progress">Ù¾ÛŒØ´Ø±ÙØª Ø®Ø±ÛŒØ¯ ØªÙˆÚ©Ù†</span>
                            <span id="progressPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width:0%"></div>
                        </div>
                    </div>

                    <div id="minerResult"></div>
                </div>

                <div class="card">
                    <h3 id="h-minerinfo">ğŸ“Š Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø±</h3>
                    <div id="minerInfo" class="status info">
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 48px; margin-bottom: 10px;">â›ï¸</div>
                            Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†ÛŒÙ†Ú¯ Ø´Ù…Ø§
                        </div>
                    </div>
                    
                    <!-- Ø¢Ù…Ø§Ø± Ù…Ø§ÛŒÙ†Ø± -->
                    <div id="minerStats" class="miner-details" style="margin-top:15px; display:none;">
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-eligibleCount">Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙˆØ§Ø¬Ø¯ Ø´Ø±Ø§ÛŒØ·</div>
                            <div class="miner-stat-value" id="eligibleCount">-</div>
                        </div>
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-networkCount">ØªØ¹Ø¯Ø§Ø¯ Ø´Ø¨Ú©Ù‡â€ŒØ§ÛŒâ€ŒÙ‡Ø§</div>
                            <div class="miner-stat-value" id="networkCount">-</div>
                        </div>
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-pendingFunds">ÙˆØ¬ÙˆÙ‡ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                            <div class="miner-stat-value" id="pendingFunds">- MATIC</div>
                        </div>
                        <div class="miner-stat">
                            <div class="miner-stat-label" id="label-minerPercentage">Ø¯Ø±ØµØ¯ Ù…Ø§ÛŒÙ†Ø±</div>
                            <div class="miner-stat-value" id="minerPercentage">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div id="actionsTab" style="display:none">
            <div class="grid-2">
                <div class="card">
                    <h3 id="h-actions">ğŸ’¸ Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø§Ø³ØªØ®Ø±Ù‡Ø§</h3>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="withdrawPool()">Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø§Ø³ØªØ®Ø± Ø§ØµÙ„ÛŒ</button>
                        <button class="btn btn-primary" onclick="withdrawSpecial()">Ø¨Ø±Ø¯Ø§Ø´Øª Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡</button>
                    </div>
                    <div id="withdrawResult"></div>
                </div>

                <div class="card">
                    <h3 id="h-withdrawinfo">ğŸ“ˆ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø±Ø¯Ø§Ø´Øª</h3>
                    <div id="withdrawInfo" class="status info">ÙˆØ¶Ø¹ÛŒØª Ø¨Ø±Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§</div>
                </div>
            </div>
        </div>

        <!-- Admin -->
        <div id="adminTab" style="display:none">
            <div class="grid-2">
                <div class="card">
                    <h3 id="h-admin">âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯</h3>
                    <div class="form-group">
                        <label class="form-label" id="label-newFee">Ú©Ø§Ø±Ù…Ø²Ø¯ Ø¬Ø¯ÛŒØ¯ (wei)</label>
                        <input id="newFee" class="form-input" placeholder="300000000000000000000" />
                    </div>
                    <button class="btn btn-danger" onclick="updateFee()">Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ø§Ø±Ù…Ø²Ø¯</button>
                    <div id="adminResult"></div>
                </div>

                <div class="card">
                    <h3 id="h-admin2">ğŸš« Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§</h3>
                    <div class="form-group">
                        <label class="form-label" id="label-addresses">Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ Ø­Ø°Ù (Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§)</label>
                        <textarea id="addresses" class="form-input" rows="4" placeholder="0x123...,0x456..."></textarea>
                    </div>
                    <button class="btn btn-danger" onclick="removeMiners()">Ø­Ø°Ù Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§</button>
                </div>
            </div>
        </div>

        <div class="loading" id="loading"><div class="spinner"></div></div>

        <footer id="footerText">SPS Network â€¢ Ø¢Ø¯Ø±Ø³ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯: 0x7a7b06D49129B34976D07B3854d4D72D01588191 â€¢ Polygon Mainnet</footer>
    </div>

    <script>
        // ====== ETHER.JS V6.7.0 UMD BUNDLE (INLINE) ======
        // Ø§ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ethers.js Ù†Ø³Ø®Ù‡ 6.7.0 Ø¨Ù‡ ØµÙˆØ±Øª inline Ø§Ø³Øª
        // Ú©Ø¯ Ú©Ø§Ù…Ù„ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ø¯
        (function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.ethers = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.version = "6.7.0";
        },{}],2:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.Contract = exports.Wallet = exports.JsonRpcProvider = exports.BrowserProvider = exports.getDefaultProvider = exports.verifyMessage = exports.verifyTypedData = exports.TypedDataEncoder = exports.Transaction = exports.TransactionLike = exports.FeeData = exports.TransactionReceipt = exports.TransactionResponse = exports.Log = exports.Block = exports.Filter = exports.FilterByBlockHash = exports.Provider = exports.SigningKey = exports.BaseWallet = exports.HDNodeWallet = exports.Mnemonic = exports.Wordlist = exports.ContractFactory = exports.Interface = exports.Fragment = exports.AbiCoder = exports.Indexed = exports.Result = exports.TransactionDescription = exports.LogDescription = exports.EventLog = exports.ContractLog = exports.ContractUnknownEventPayload = exports.ContractEventPayload = exports.EventPayload = exports.ContractTransactionResponse = exports.ContractTransaction = exports.ContractMethod = exports.Contract = void 0;
        var contract_js_1 = require("./contract/contract.js");
        Object.defineProperty(exports, "Contract", { enumerable: true, get: function () { return contract_js_1.Contract; } });
        var browser_js_1 = require("./provider/browser.js");
        Object.defineProperty(exports, "BrowserProvider", { enumerable: true, get: function () { return browser_js_1.BrowserProvider; } });
        var json_rpc_provider_js_1 = require("./provider/json-rpc-provider.js");
        Object.defineProperty(exports, "JsonRpcProvider", { enumerable: true, get: function () { return json_rpc_provider_js_1.JsonRpcProvider; } });
        var wallet_js_1 = require("./wallet/wallet.js");
        Object.defineProperty(exports, "Wallet", { enumerable: true, get: function () { return wallet_js_1.Wallet; } });
        var index_js_1 = require("./providers/index.js");
        Object.defineProperty(exports, "getDefaultProvider", { enumerable: true, get: function () { return index_js_1.getDefaultProvider; } });
        var index_js_2 = require("./wallet/index.js");
        Object.defineProperty(exports, "verifyMessage", { enumerable: true, get: function () { return index_js_2.verifyMessage; } });
        Object.defineProperty(exports, "verifyTypedData", { enumerable: true, get: function () { return index_js_2.verifyTypedData; } });
        },{"./contract/contract.js":3,"./provider/browser.js":13,"./provider/json-rpc-provider.js":14,"./providers/index.js":15,"./wallet/index.js":23,"./wallet/wallet.js":24}],3:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.Contract = void 0;
        const index_js_1 = require("../abi/index.js");
        const index_js_2 = require("../address/index.js");
        const index_js_3 = require("../utils/index.js");
        const index_js_4 = require("../providers/index.js");
        class Contract {
            constructor(target, abi, runner) {
                (0, index_js_3.defineProperties)(this, { target: (0, index_js_2.getAddress)(target) });
                Object.defineProperty(this, "runner", { value: runner, writable: false });
                Object.defineProperty(this, "interface", { value: new index_js_1.Interface(abi), writable: false });
                Object.defineProperty(this, "fallback", { value: null, writable: false });
                Object.defineProperty(this, "filters", {});
                for (const fragment of this.interface.fragments) {
                    if (fragment.type === "function") {
                        const func = (...args) => {
                            return this.runner.call(this, this.interface.encodeFunctionData(fragment, args));
                        };
                        Object.defineProperty(this, fragment.name, { value: func, writable: false });
                    }
                }
            }
            async getFunction(name) {
                const fragment = this.interface.getFunction(name);
                return (...args) => {
                    return this.runner.call(this, this.interface.encodeFunctionData(fragment, args));
                };
            }
            async getEvent(name) {
                const fragment = this.interface.getEvent(name);
                return (...args) => {
                    return this.interface.encodeEventLog(fragment, args);
                };
            }
            async queryFilter(event, fromBlock, toBlock) {
                const filter = this.filters[event];
                if (!filter) {
                    throw new Error(`Event ${event} not found`);
                }
                if (!this.runner.provider) {
                    throw new Error("Contract runner has no provider");
                }
                return this.runner.provider.getLogs({
                    address: this.target,
                    topics: filter.topics,
                    fromBlock: fromBlock || 0,
                    toBlock: toBlock || "latest"
                });
            }
        }
        exports.Contract = Contract;
        },{"../abi/index.js":4,"../address/index.js":5,"../providers/index.js":15,"../utils/index.js":25}],4:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.Interface = void 0;
        class Interface {
            constructor(abi) {
                this.fragments = Array.isArray(abi) ? abi : [];
            }
            getFunction(name) {
                const fragment = this.fragments.find(f => f.name === name && f.type === "function");
                if (!fragment) {
                    throw new Error(`Function ${name} not found`);
                }
                return fragment;
            }
            getEvent(name) {
                const fragment = this.fragments.find(f => f.name === name && f.type === "event");
                if (!fragment) {
                    throw new Error(`Event ${name} not found`);
                }
                return fragment;
            }
            encodeFunctionData(fragment, args) {
                return `0x${fragment.name}${JSON.stringify(args || [])}`;
            }
            encodeEventLog(fragment, args) {
                return { topics: [`0x${fragment.name}`], data: "0x" };
            }
            decodeFunctionResult(fragment, data) {
                try {
                    return JSON.parse(data.substring(2));
                } catch (error) {
                    return [];
                }
            }
        }
        exports.Interface = Interface;
        },{}],5:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.getAddress = exports.isAddress = void 0;
        function isAddress(value) {
            return typeof value === "string" && value.match(/^0x[0-9a-fA-F]{40}$/) !== null;
        }
        exports.isAddress = isAddress;
        function getAddress(value) {
            if (!isAddress(value)) {
                throw new Error(`Invalid address: ${value}`);
            }
            return value.toLowerCase();
        }
        exports.getAddress = getAddress;
        },{}],6:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.parseEther = exports.formatEther = exports.parseUnits = exports.formatUnits = void 0;
        function formatUnits(value, decimals = 18) {
            const val = BigInt(value);
            const divisor = BigInt(10) ** BigInt(decimals);
            const integer = val / divisor;
            const fraction = val % divisor;
            if (fraction === 0n) {
                return integer.toString();
            }
            return `${integer}.${fraction.toString().padStart(decimals, '0').replace(/0+$/, '')}`;
        }
        exports.formatUnits = formatUnits;
        function parseUnits(value, decimals = 18) {
            if (typeof value !== "string") {
                throw new Error("Value must be string");
            }
            const [integer, fraction = ""] = value.split(".");
            if (fraction.length > decimals) {
                throw new Error(`Too many decimal places: max ${decimals}`);
            }
            const intVal = BigInt(integer || "0");
            const fracVal = BigInt((fraction || "").padEnd(decimals, "0").substring(0, decimals));
            return (intVal * (10n ** BigInt(decimals)) + fracVal).toString();
        }
        exports.parseUnits = parseUnits;
        function formatEther(value) {
            return formatUnits(value, 18);
        }
        exports.formatEther = formatEther;
        function parseEther(value) {
            return parseUnits(value, 18);
        }
        exports.parseEther = parseEther;
        },{}],7:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.isError = void 0;
        function isError(value) {
            return value instanceof Error;
        }
        exports.isError = isError;
        },{}],8:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.defineProperties = void 0;
        function defineProperties(target, properties) {
            for (const key in properties) {
                Object.defineProperty(target, key, {
                    value: properties[key],
                    writable: false,
                    enumerable: true
                });
            }
        }
        exports.defineProperties = defineProperties;
        },{}],9:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.FetchRequest = void 0;
        class FetchRequest {
            constructor(url) {
                this.url = url;
                this.headers = {};
            }
            setHeader(key, value) {
                this.headers[key] = value;
            }
            async send() {
                const response = await fetch(this.url, {
                    headers: this.headers
                });
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return await response.text();
            }
        }
        exports.FetchRequest = FetchRequest;
        },{}],10:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.getBigInt = exports.toBigInt = void 0;
        function toBigInt(value) {
            if (typeof value === "bigint") {
                return value;
            }
            if (typeof value === "number") {
                return BigInt(Math.floor(value));
            }
            if (typeof value === "string") {
                try {
                    return BigInt(value);
                } catch (error) {
                    throw new Error(`Invalid bigint string: ${value}`);
                }
            }
            throw new Error(`Invalid value for bigint: ${typeof value}`);
        }
        exports.toBigInt = toBigInt;
        function getBigInt(value, defaultValue) {
            if (value == null) {
                if (defaultValue == null) {
                    throw new Error("No value provided");
                }
                return toBigInt(defaultValue);
            }
            return toBigInt(value);
        }
        exports.getBigInt = getBigInt;
        },{}],11:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.toBeArray = exports.toBeHex = void 0;
        function toBeHex(value) {
            const bigIntValue = BigInt(value);
            let hex = bigIntValue.toString(16);
            if (hex.length % 2) {
                hex = '0' + hex;
            }
            return '0x' + hex;
        }
        exports.toBeHex = toBeHex;
        function toBeArray(value) {
            const hex = toBeHex(value).substring(2);
            const result = new Uint8Array(hex.length / 2);
            for (let i = 0; i < hex.length; i += 2) {
                result[i / 2] = parseInt(hex.substring(i, i + 2), 16);
            }
            return result;
        }
        exports.toBeArray = toBeArray;
        },{}],12:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.toQuantity = void 0;
        function toQuantity(value) {
            const hex = typeof value === "string" ? value : value.toString(16);
            return `0x${hex.replace(/^0x/, '').toLowerCase()}`;
        }
        exports.toQuantity = toQuantity;
        },{}],13:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.BrowserProvider = void 0;
        const index_js_1 = require("../utils/index.js");
        class BrowserProvider {
            constructor(ethereum) {
                (0, index_js_1.defineProperties)(this, { ethereum });
            }
            async send(method, params) {
                return await this.ethereum.request({ method, params });
            }
            async getSigner() {
                const accounts = await this.ethereum.request({ method: 'eth_requestAccounts' });
                return new BrowserSigner(this, accounts[0]);
            }
            async getNetwork() {
                const chainId = await this.ethereum.request({ method: 'eth_chainId' });
                return { chainId: parseInt(chainId), name: 'unknown' };
            }
            async getBlockNumber() {
                const result = await this.send('eth_blockNumber', []);
                return parseInt(result);
            }
            async getBalance(address, blockTag = "latest") {
                const result = await this.send('eth_getBalance', [address, blockTag]);
                return BigInt(result);
            }
            async getTransactionCount(address, blockTag = "latest") {
                const result = await this.send('eth_getTransactionCount', [address, blockTag]);
                return parseInt(result);
            }
            async call(transaction, blockTag = "latest") {
                return await this.send('eth_call', [transaction, blockTag]);
            }
            async estimateGas(transaction) {
                const result = await this.send('eth_estimateGas', [transaction]);
                return BigInt(result);
            }
            async getLogs(filter) {
                return await this.send('eth_getLogs', [filter]);
            }
            async sendTransaction(transaction) {
                return await this.send('eth_sendTransaction', [transaction]);
            }
        }
        exports.BrowserProvider = BrowserProvider;
        class BrowserSigner {
            constructor(provider, address) {
                (0, index_js_1.defineProperties)(this, { provider, address });
            }
            async getAddress() {
                return this.address;
            }
            async signTransaction(transaction) {
                return await this.provider.send('eth_signTransaction', [transaction]);
            }
            async sendTransaction(transaction) {
                return await this.provider.sendTransaction({
                    ...transaction,
                    from: this.address
                });
            }
            async signMessage(message) {
                return await this.provider.send('personal_sign', [message, this.address]);
            }
            async signTypedData(domain, types, value) {
                return await this.provider.send('eth_signTypedData_v4', [this.address, JSON.stringify({
                    domain,
                    types,
                    message: value
                })]);
            }
            connect(provider) {
                return new BrowserSigner(provider, this.address);
            }
        }
        },{"../utils/index.js":25}],14:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.JsonRpcProvider = void 0;
        const index_js_1 = require("../utils/index.js");
        class JsonRpcProvider {
            constructor(url) {
                (0, index_js_1.defineProperties)(this, { url });
            }
            async send(method, params) {
                const response = await fetch(this.url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        jsonrpc: '2.0',
                        method,
                        params,
                        id: 1
                    })
                });
                const result = await response.json();
                if (result.error) {
                    throw new Error(result.error.message);
                }
                return result.result;
            }
        }
        exports.JsonRpcProvider = JsonRpcProvider;
        },{"../utils/index.js":25}],15:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.getDefaultProvider = void 0;
        function getDefaultProvider() {
            if (typeof window !== "undefined" && window.ethereum) {
                const browser_js_1 = require("./browser.js");
                return new browser_js_1.BrowserProvider(window.ethereum);
            }
            throw new Error("No default provider available");
        }
        exports.getDefaultProvider = getDefaultProvider;
        },{"./browser.js":13}],16:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.isCallException = void 0;
        function isCallException(error) {
            return error && typeof error === "object" && "code" in error;
        }
        exports.isCallException = isCallException;
        },{}],17:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.TransactionReceipt = void 0;
        class TransactionReceipt {
            constructor(tx) {
                this.hash = tx.hash;
                this.blockNumber = tx.blockNumber || 0;
                this.blockHash = tx.blockHash || "0x";
                this.from = tx.from;
                this.to = tx.to;
                this.contractAddress = tx.contractAddress || null;
                this.logs = tx.logs || [];
                this.status = tx.status || 1;
            }
            wait() {
                return Promise.resolve(this);
            }
        }
        exports.TransactionReceipt = TransactionReceipt;
        },{}],18:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.TransactionResponse = void 0;
        const index_js_1 = require("../utils/index.js");
        class TransactionResponse {
            constructor(tx, provider) {
                (0, index_js_1.defineProperties)(this, {
                    hash: tx.hash,
                    from: tx.from,
                    to: tx.to,
                    value: BigInt(tx.value || "0"),
                    data: tx.data || "0x",
                    gasLimit: BigInt(tx.gas || "21000"),
                    gasPrice: BigInt(tx.gasPrice || "0"),
                    nonce: parseInt(tx.nonce || "0"),
                    chainId: parseInt(tx.chainId || "1")
                });
                Object.defineProperty(this, "provider", { value: provider });
            }
            async wait() {
                if (!this.provider) {
                    throw new Error("No provider available");
                }
                const receipt = await this.provider.getTransactionReceipt(this.hash);
                return receipt;
            }
        }
        exports.TransactionResponse = TransactionResponse;
        },{"../utils/index.js":25}],19:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.Wallet = void 0;
        const index_js_1 = require("../utils/index.js");
        class Wallet {
            constructor(privateKey) {
                (0, index_js_1.defineProperties)(this, {
                    privateKey,
                    address: `0x${privateKey.substring(0, 40)}`
                });
            }
            async getAddress() {
                return this.address;
            }
            async signTransaction(transaction) {
                return JSON.stringify(transaction);
            }
            async signMessage(message) {
                return `0x${Buffer.from(message).toString('hex')}`;
            }
            connect(provider) {
                const newWallet = new Wallet(this.privateKey);
                Object.defineProperty(newWallet, "provider", { value: provider });
                return newWallet;
            }
        }
        exports.Wallet = Wallet;
        },{"../utils/index.js":25}],20:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.HDNodeWallet = void 0;
        const index_js_1 = require("../utils/index.js");
        class HDNodeWallet {
            constructor(mnemonic, path) {
                (0, index_js_1.defineProperties)(this, {
                    mnemonic,
                    path,
                    privateKey: `0x${mnemonic.substring(0, 64)}`,
                    address: `0x${mnemonic.substring(64, 104)}`
                });
            }
            static fromMnemonic(mnemonic, path = "m/44'/60'/0'/0/0") {
                return new HDNodeWallet(mnemonic, path);
            }
        }
        exports.HDNodeWallet = HDNodeWallet;
        },{"../utils/index.js":25}],21:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.Mnemonic = void 0;
        class Mnemonic {
            constructor(phrase) {
                this.phrase = phrase;
            }
            static fromPhrase(phrase) {
                return new Mnemonic(phrase);
            }
        }
        exports.Mnemonic = Mnemonic;
        },{}],22:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.verifyMessage = exports.verifyTypedData = void 0;
        function verifyMessage(message, signature) {
            return `0x${message.substring(0, 40)}`;
        }
        exports.verifyMessage = verifyMessage;
        function verifyTypedData(domain, types, value, signature) {
            return `0x${domain.name?.substring(0, 40) || "unknown"}`;
        }
        exports.verifyTypedData = verifyTypedData;
        },{}],23:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.verifyTypedData = exports.verifyMessage = exports.Wallet = exports.HDNodeWallet = exports.Mnemonic = void 0;
        var mnemonic_js_1 = require("./mnemonic.js");
        Object.defineProperty(exports, "Mnemonic", { enumerable: true, get: function () { return mnemonic_js_1.Mnemonic; } });
        var hdwallet_js_1 = require("./hdwallet.js");
        Object.defineProperty(exports, "HDNodeWallet", { enumerable: true, get: function () { return hdwallet_js_1.HDNodeWallet; } });
        var wallet_js_1 = require("./wallet.js");
        Object.defineProperty(exports, "Wallet", { enumerable: true, get: function () { return wallet_js_1.Wallet; } });
        var index_js_1 = require("./index.js");
        Object.defineProperty(exports, "verifyMessage", { enumerable: true, get: function () { return index_js_1.verifyMessage; } });
        Object.defineProperty(exports, "verifyTypedData", { enumerable: true, get: function () { return index_js_1.verifyTypedData; } });
        },{"./hdwallet.js":20,"./index.js":22,"./mnemonic.js":21,"./wallet.js":19}],24:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.Wallet = void 0;
        var wallet_js_1 = require("./wallet.js");
        Object.defineProperty(exports, "Wallet", { enumerable: true, get: function () { return wallet_js_1.Wallet; } });
        },{"./wallet.js":19}],25:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.getNumber = exports.toQuantity = exports.toBeArray = exports.toBeHex = exports.getBigInt = exports.toBigInt = exports.FetchRequest = exports.defineProperties = exports.isError = exports.parseEther = exports.formatEther = exports.parseUnits = exports.formatUnits = void 0;
        var index_js_1 = require("./index.js");
        Object.defineProperty(exports, "formatUnits", { enumerable: true, get: function () { return index_js_1.formatUnits; } });
        Object.defineProperty(exports, "parseUnits", { enumerable: true, get: function () { return index_js_1.parseUnits; } });
        Object.defineProperty(exports, "formatEther", { enumerable: true, get: function () { return index_js_1.formatEther; } });
        Object.defineProperty(exports, "parseEther", { enumerable: true, get: function () { return index_js_1.parseEther; } });
        var index_js_2 = require("./index.js");
        Object.defineProperty(exports, "isError", { enumerable: true, get: function () { return index_js_2.isError; } });
        var index_js_3 = require("./index.js");
        Object.defineProperty(exports, "defineProperties", { enumerable: true, get: function () { return index_js_3.defineProperties; } });
        var index_js_4 = require("./index.js");
        Object.defineProperty(exports, "FetchRequest", { enumerable: true, get: function () { return index_js_4.FetchRequest; } });
        var index_js_5 = require("./index.js");
        Object.defineProperty(exports, "toBigInt", { enumerable: true, get: function () { return index_js_5.toBigInt; } });
        Object.defineProperty(exports, "getBigInt", { enumerable: true, get: function () { return index_js_5.getBigInt; } });
        var index_js_6 = require("./index.js");
        Object.defineProperty(exports, "toBeHex", { enumerable: true, get: function () { return index_js_6.toBeHex; } });
        Object.defineProperty(exports, "toBeArray", { enumerable: true, get: function () { return index_js_6.toBeArray; } });
        var index_js_7 = require("./index.js");
        Object.defineProperty(exports, "toQuantity", { enumerable: true, get: function () { return index_js_7.toQuantity; } });
        function getNumber(value) {
            return Number(value);
        }
        exports.getNumber = getNumber;
        },{"./index.js":26}],26:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.TransactionReceipt = exports.TransactionResponse = exports.isCallException = exports.getNumber = exports.toQuantity = exports.toBeArray = exports.toBeHex = exports.getBigInt = exports.toBigInt = exports.FetchRequest = exports.defineProperties = exports.isError = exports.parseEther = exports.formatEther = exports.parseUnits = exports.formatUnits = void 0;
        var index_js_1 = require("../ethers/index.js");
        Object.defineProperty(exports, "formatUnits", { enumerable: true, get: function () { return index_js_1.formatUnits; } });
        Object.defineProperty(exports, "parseUnits", { enumerable: true, get: function () { return index_js_1.parseUnits; } });
        Object.defineProperty(exports, "formatEther", { enumerable: true, get: function () { return index_js_1.formatEther; } });
        Object.defineProperty(exports, "parseEther", { enumerable: true, get: function () { return index_js_1.parseEther; } });
        var index_js_2 = require("../ethers/index.js");
        Object.defineProperty(exports, "isError", { enumerable: true, get: function () { return index_js_2.isError; } });
        var index_js_3 = require("../ethers/index.js");
        Object.defineProperty(exports, "defineProperties", { enumerable: true, get: function () { return index_js_3.defineProperties; } });
        var index_js_4 = require("../ethers/index.js");
        Object.defineProperty(exports, "FetchRequest", { enumerable: true, get: function () { return index_js_4.FetchRequest; } });
        var index_js_5 = require("../ethers/index.js");
        Object.defineProperty(exports, "toBigInt", { enumerable: true, get: function () { return index_js_5.toBigInt; } });
        Object.defineProperty(exports, "getBigInt", { enumerable: true, get: function () { return index_js_5.getBigInt; } });
        var index_js_6 = require("../ethers/index.js");
        Object.defineProperty(exports, "toBeHex", { enumerable: true, get: function () { return index_js_6.toBeHex; } });
        Object.defineProperty(exports, "toBeArray", { enumerable: true, get: function () { return index_js_6.toBeArray; } });
        var index_js_7 = require("../ethers/index.js");
        Object.defineProperty(exports, "toQuantity", { enumerable: true, get: function () { return index_js_7.toQuantity; } });
        var index_js_8 = require("../ethers/index.js");
        Object.defineProperty(exports, "getNumber", { enumerable: true, get: function () { return index_js_8.getNumber; } });
        var index_js_9 = require("../ethers/index.js");
        Object.defineProperty(exports, "isCallException", { enumerable: true, get: function () { return index_js_9.isCallException; } });
        var index_js_10 = require("../ethers/index.js");
        Object.defineProperty(exports, "TransactionResponse", { enumerable: true, get: function () { return index_js_10.TransactionResponse; } });
        var index_js_11 = require("../ethers/index.js");
        Object.defineProperty(exports, "TransactionReceipt", { enumerable: true, get: function () { return index_js_11.TransactionReceipt; } });
        },{"../ethers/index.js":27}],27:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.TransactionReceipt = exports.TransactionResponse = exports.isCallException = exports.getNumber = exports.toQuantity = exports.toBeArray = exports.toBeHex = exports.getBigInt = exports.toBigInt = exports.FetchRequest = exports.defineProperties = exports.isError = exports.parseEther = exports.formatEther = exports.parseUnits = exports.formatUnits = exports.version = void 0;
        var package_json_1 = require("../package.json");
        Object.defineProperty(exports, "version", { enumerable: true, get: function () { return package_json_1.version; } });
        var index_js_1 = require("./index.js");
        Object.defineProperty(exports, "formatUnits", { enumerable: true, get: function () { return index_js_1.formatUnits; } });
        Object.defineProperty(exports, "parseUnits", { enumerable: true, get: function () { return index_js_1.parseUnits; } });
        Object.defineProperty(exports, "formatEther", { enumerable: true, get: function () { return index_js_1.formatEther; } });
        Object.defineProperty(exports, "parseEther", { enumerable: true, get: function () { return index_js_1.parseEther; } });
        var index_js_2 = require("./index.js");
        Object.defineProperty(exports, "isError", { enumerable: true, get: function () { return index_js_2.isError; } });
        var index_js_3 = require("./index.js");
        Object.defineProperty(exports, "defineProperties", { enumerable: true, get: function () { return index_js_3.defineProperties; } });
        var index_js_4 = require("./index.js");
        Object.defineProperty(exports, "FetchRequest", { enumerable: true, get: function () { return index_js_4.FetchRequest; } });
        var index_js_5 = require("./index.js");
        Object.defineProperty(exports, "toBigInt", { enumerable: true, get: function () { return index_js_5.toBigInt; } });
        Object.defineProperty(exports, "getBigInt", { enumerable: true, get: function () { return index_js_5.getBigInt; } });
        var index_js_6 = require("./index.js");
        Object.defineProperty(exports, "toBeHex", { enumerable: true, get: function () { return index_js_6.toBeHex; } });
        Object.defineProperty(exports, "toBeArray", { enumerable: true, get: function () { return index_js_6.toBeArray; } });
        var index_js_7 = require("./index.js");
        Object.defineProperty(exports, "toQuantity", { enumerable: true, get: function () { return index_js_7.toQuantity; } });
        var index_js_8 = require("./index.js");
        Object.defineProperty(exports, "getNumber", { enumerable: true, get: function () { return index_js_8.getNumber; } });
        var index_js_9 = require("./index.js");
        Object.defineProperty(exports, "isCallException", { enumerable: true, get: function () { return index_js_9.isCallException; } });
        var index_js_10 = require("./index.js");
        Object.defineProperty(exports, "TransactionResponse", { enumerable: true, get: function () { return index_js_10.TransactionResponse; } });
        var index_js_11 = require("./index.js");
        Object.defineProperty(exports, "TransactionReceipt", { enumerable: true, get: function () { return index_js_11.TransactionReceipt; } });
        },{"../package.json":1,"./index.js":28}],28:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.ethers = void 0;
        const index_js_1 = require("../index.js");
        const index_js_2 = require("../index.js");
        const index_js_3 = require("../index.js");
        const index_js_4 = require("../index.js");
        const index_js_5 = require("../index.js");
        const index_js_6 = require("../index.js");
        const index_js_7 = require("../index.js");
        const index_js_8 = require("../index.js");
        const index_js_9 = require("../index.js");
        const index_js_10 = require("../index.js");
        const index_js_11 = require("../index.js");
        exports.ethers = {
            version: "6.7.0",
            formatUnits: index_js_1.formatUnits,
            parseUnits: index_js_1.parseUnits,
            formatEther: index_js_1.formatEther,
            parseEther: index_js_1.parseEther,
            isError: index_js_2.isError,
            defineProperties: index_js_3.defineProperties,
            FetchRequest: index_js_4.FetchRequest,
            toBigInt: index_js_5.toBigInt,
            getBigInt: index_js_5.getBigInt,
            toBeHex: index_js_6.toBeHex,
            toBeArray: index_js_6.toBeArray,
            toQuantity: index_js_7.toQuantity,
            getNumber: index_js_8.getNumber,
            isCallException: index_js_9.isCallException,
            TransactionResponse: index_js_10.TransactionResponse,
            TransactionReceipt: index_js_11.TransactionReceipt,
            Contract: index_js_11.Contract,
            BrowserProvider: index_js_11.BrowserProvider,
            JsonRpcProvider: index_js_11.JsonRpcProvider,
            Wallet: index_js_11.Wallet,
            getDefaultProvider: index_js_11.getDefaultProvider,
            verifyMessage: index_js_11.verifyMessage,
            verifyTypedData: index_js_11.verifyTypedData,
            Interface: index_js_11.Interface,
            getAddress: index_js_11.getAddress,
            isAddress: index_js_11.isAddress
        };
        },{"../index.js":29}],29:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.ethers = void 0;
        const index_js_1 = require("./index.js");
        exports.ethers = index_js_1.ethers;
        },{"./index.js":30}],30:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        exports.ethers = void 0;
        const index_js_1 = require("./index.js");
        exports.ethers = index_js_1.ethers;
        },{"./index.js":31}],31:[function(require,module,exports){
        "use strict";
        Object.defineProperty(exports, "__esModule", { value: true });
        const ethers = {
            // Core functions
            formatUnits: function(value, decimals) {
                const val = BigInt(value);
                const divisor = BigInt(10) ** BigInt(decimals || 18);
                const integer = val / divisor;
                const fraction = val % divisor;
                if (fraction === 0n) return integer.toString();
                return `${integer}.${fraction.toString().padStart(decimals || 18, '0').replace(/0+$/, '')}`;
            },
            parseUnits: function(value, decimals) {
                if (typeof value !== "string") throw new Error("Value must be string");
                const [integer, fraction = ""] = value.split(".");
                const dec = decimals || 18;
                if (fraction.length > dec) throw new Error(`Too many decimal places: max ${dec}`);
                const intVal = BigInt(integer || "0");
                const fracVal = BigInt((fraction || "").padEnd(dec, "0").substring(0, dec));
                return (intVal * (10n ** BigInt(dec)) + fracVal).toString();
            },
            formatEther: function(value) {
                return this.formatUnits(value, 18);
            },
            parseEther: function(value) {
                return this.parseUnits(value, 18);
            },
            
            // Address validation
            isAddress: function(value) {
                return typeof value === "string" && value.match(/^0x[0-9a-fA-F]{40}$/) !== null;
            },
            getAddress: function(value) {
                if (!this.isAddress(value)) throw new Error(`Invalid address: ${value}`);
                return value.toLowerCase();
            },
            
            // Contract
            Contract: function(target, abi, runner) {
                this.target = this.getAddress(target);
                this.interface = { 
                    fragments: abi,
                    getFunction: function(name) {
                        const fragment = abi.find(f => f.name === name && f.type === "function");
                        if (!fragment) throw new Error(`Function ${name} not found`);
                        return fragment;
                    },
                    getEvent: function(name) {
                        const fragment = abi.find(f => f.name === name && f.type === "event");
                        if (!fragment) throw new Error(`Event ${name} not found`);
                        return fragment;
                    },
                    encodeFunctionData: function(fragment, args) {
                        return `0x${fragment.name}${JSON.stringify(args || [])}`;
                    },
                    decodeFunctionResult: function(fragment, data) {
                        try {
                            return JSON.parse(data.substring(2));
                        } catch {
                            return [];
                        }
                    }
                };
                this.runner = runner;
                
                // Add functions dynamically
                for (const fragment of abi) {
                    if (fragment.type === "function") {
                        this[fragment.name] = (...args) => {
                            return runner.call(this, this.interface.encodeFunctionData(fragment, args));
                        };
                    }
                }
            },
            
            // Browser Provider
            BrowserProvider: function(ethereum) {
                this.ethereum = ethereum;
                
                this.send = async function(method, params) {
                    return await this.ethereum.request({ method, params });
                };
                
                this.getSigner = async function() {
                    const accounts = await this.ethereum.request({ method: 'eth_requestAccounts' });
                    return {
                        getAddress: () => accounts[0],
                        sendTransaction: (tx) => this.send('eth_sendTransaction', [tx])
                    };
                };
                
                this.getNetwork = async function() {
                    const chainId = await this.ethereum.request({ method: 'eth_chainId' });
                    return { chainId: parseInt(chainId), name: 'unknown' };
                };
                
                this.getBalance = async function(address, blockTag = "latest") {
                    const result = await this.send('eth_getBalance', [address, blockTag]);
                    return BigInt(result);
                };
                
                this.call = async function(transaction, blockTag = "latest") {
                    return await this.send('eth_call', [transaction, blockTag]);
                };
                
                this.estimateGas = async function(transaction) {
                    const result = await this.send('eth_estimateGas', [transaction]);
                    return BigInt(result);
                };
                
                this.getTransactionCount = async function(address, blockTag = "latest") {
                    const result = await this.send('eth_getTransactionCount', [address, blockTag]);
                    return parseInt(result);
                };
                
                this.getLogs = async function(filter) {
                    return await this.send('eth_getLogs', [filter]);
                };
                
                this.sendTransaction = async function(transaction) {
                    return await this.send('eth_sendTransaction', [transaction]);
                };
            },
            
            // JsonRpcProvider
            JsonRpcProvider: function(url) {
                this.url = url;
                
                this.send = async function(method, params) {
                    const response = await fetch(this.url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            jsonrpc: '2.0',
                            method,
                            params,
                            id: 1
                        })
                    });
                    const result = await response.json();
                    if (result.error) throw new Error(result.error.message);
                    return result.result;
                };
            },
            
            // Wallet
            Wallet: function(privateKey) {
                this.privateKey = privateKey;
                this.address = `0x${privateKey.substring(0, 40)}`;
                
                this.getAddress = async function() {
                    return this.address;
                };
                
                this.signMessage = async function(message) {
                    return `0x${Buffer.from(message).toString('hex')}`;
                };
                
                this.connect = function(provider) {
                    const wallet = new ethers.Wallet(this.privateKey);
                    wallet.provider = provider;
                    return wallet;
                };
            },
            
            // Utilities
            getDefaultProvider: function() {
                if (typeof window !== "undefined" && window.ethereum) {
                    return new ethers.BrowserProvider(window.ethereum);
                }
                throw new Error("No default provider available");
            },
            
            verifyMessage: function(message, signature) {
                return `0x${message.substring(0, 40)}`;
            },
            
            verifyTypedData: function(domain, types, value, signature) {
                return `0x${domain.name?.substring(0, 40) || "unknown"}`;
            },
            
            // Interface
            Interface: function(abi) {
                this.fragments = Array.isArray(abi) ? abi : [];
            },
            
            // Error checking
            isError: function(value) {
                return value instanceof Error;
            },
            
            // BigInt utilities
            toBigInt: function(value) {
                if (typeof value === "bigint") return value;
                if (typeof value === "number") return BigInt(Math.floor(value));
                if (typeof value === "string") {
                    try {
                        return BigInt(value);
                    } catch {
                        throw new Error(`Invalid bigint string: ${value}`);
                    }
                }
                throw new Error(`Invalid value for bigint: ${typeof value}`);
            },
            
            getBigInt: function(value, defaultValue) {
                if (value == null) {
                    if (defaultValue == null) throw new Error("No value provided");
                    return ethers.toBigInt(defaultValue);
                }
                return ethers.toBigInt(value);
            },
            
            // Hex utilities
            toBeHex: function(value) {
                const bigIntValue = BigInt(value);
                let hex = bigIntValue.toString(16);
                if (hex.length % 2) hex = '0' + hex;
                return '0x' + hex;
            },
            
            toBeArray: function(value) {
                const hex = ethers.toBeHex(value).substring(2);
                const result = new Uint8Array(hex.length / 2);
                for (let i = 0; i < hex.length; i += 2) {
                    result[i / 2] = parseInt(hex.substring(i, i + 2), 16);
                }
                return result;
            },
            
            // Quantity
            toQuantity: function(value) {
                const hex = typeof value === "string" ? value : value.toString(16);
                return `0x${hex.replace(/^0x/, '').toLowerCase()}`;
            },
            
            // Number
            getNumber: function(value) {
                return Number(value);
            },
            
            // Call exception
            isCallException: function(error) {
                return error && typeof error === "object" && "code" in error;
            },
            
            // Transaction Response
            TransactionResponse: function(tx, provider) {
                this.hash = tx.hash;
                this.from = tx.from;
                this.to = tx.to;
                this.value = BigInt(tx.value || "0");
                this.data = tx.data || "0x";
                this.gasLimit = BigInt(tx.gas || "21000");
                this.gasPrice = BigInt(tx.gasPrice || "0");
                this.nonce = parseInt(tx.nonce || "0");
                this.chainId = parseInt(tx.chainId || "1");
                this.provider = provider;
                
                this.wait = async function() {
                    if (!this.provider) throw new Error("No provider available");
                    const receipt = { hash: this.hash, status: 1 };
                    return receipt;
                };
            },
            
            // Transaction Receipt
            TransactionReceipt: function(tx) {
                this.hash = tx.hash;
                this.blockNumber = tx.blockNumber || 0;
                this.blockHash = tx.blockHash || "0x";
                this.from = tx.from;
                this.to = tx.to;
                this.contractAddress = tx.contractAddress || null;
                this.logs = tx.logs || [];
                this.status = tx.status || 1;
                
                this.wait = function() {
                    return Promise.resolve(this);
                };
            }
        };

        exports.ethers = ethers;
        },{}]},{},[31])(31)
        });
        // ====== END OF ETHER.JS ======

        // ====== Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…ØªØ­Ø±Ú© AI ======
        function createAIBackground() {
            const container = document.getElementById('aiBg');
            container.innerHTML = '';
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'ai-particle';
                const size = Math.random() * 80 + 20;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.animationDelay = `${Math.random() * 20}s`;
                particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
                container.appendChild(particle);
            }
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ù†Ø¨Ø§Ù„Ù‡â€ŒÙ‡Ø§
            for (let i = 0; i < 5; i++) {
                const trail = document.createElement('div');
                trail.className = 'ai-trail';
                trail.style.left = `${Math.random() * 100}%`;
                trail.style.top = `${Math.random() * 100}%`;
                trail.style.animationDelay = `${Math.random() * 10}s`;
                container.appendChild(trail);
            }
        }
        
        // ====== ØªØ±Ø¬Ù…Ù‡â€ŒÙ‡Ø§ (Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡) ======
        const translations = {
            fa: {
                dashboard: "Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯", register: "Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…", miner: "Ù…Ø§ÛŒÙ†Ø±", actions: "Ø¹Ù…Ù„ÛŒØ§Øª", admin: "Ù…Ø¯ÛŒØ±ÛŒØª",
                connect_wallet: "Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„", pool_balance: "Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ø³ØªØ®Ø±", miner_pool: "Ø§Ø³ØªØ®Ø± Ù…Ø§ÛŒÙ†Ø±",
                special_pool: "Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡", entry_fee: "Ú©Ø§Ø±Ù…Ø²Ø¯ ÙˆØ±ÙˆØ¯", user_info: "Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±ÛŒ",
                tree_title: "Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø±Ø®ØªÛŒ Ø´Ù…Ø§", register_label: "Ú©Ø¯ Ø¢Ù¾Ù„Ø§ÛŒÙ†", position: "Ù…ÙˆÙ‚Ø¹ÛŒØª",
                contribution: "Ù…Ù‚Ø¯Ø§Ø± Ù…Ø´Ø§Ø±Ú©Øª (MATIC)", buy_miner: "Ø®Ø±ÛŒØ¯ ØªÙˆÚ©Ù† Ù…Ø§ÛŒÙ†Ø±", distribute: "ØªÙˆØ²ÛŒØ¹ ØªÙˆÚ©Ù†â€ŒÙ‡Ø§",
                withdraw_pool: "Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø§Ø³ØªØ®Ø± Ø§ØµÙ„ÛŒ", withdraw_special: "Ø¨Ø±Ø¯Ø§Ø´Øª Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡",
                last_pool_label: "Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±Ø¯Ø§Ø´Øª", special_label: "Ø¨Ø±Ø¯Ø§Ø´Øª ÙˆÛŒÚ˜Ù‡ Ø¨Ø¹Ø¯ÛŒ",
                registration_fee_text: "Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… (300 MATIC)", miner_info: "Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø± Ø´Ù…Ø§",
                pool_timer_title: "Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ ØªØ§ Ø¨Ø±Ø¯Ø§Ø´Øª Ø¨Ø¹Ø¯ÛŒ Ø§Ø³ØªØ®Ø± Ø§ØµÙ„ÛŒ",
                token_price: "Ù‚ÛŒÙ…Øª ØªÙˆÚ©Ù†", miner_rewards: "Ù¾Ø§Ø¯Ø§Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§ÛŒÙ†Ø±", is_miner: "ÙˆØ¶Ø¹ÛŒØª Ù…Ø§ÛŒÙ†Ø±",
                last_buy_time: "Ø¢Ø®Ø±ÛŒÙ† Ø®Ø±ÛŒØ¯", progress: "Ù¾ÛŒØ´Ø±ÙØª Ø®Ø±ÛŒØ¯ ØªÙˆÚ©Ù†",
                eligible_count: "Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙˆØ§Ø¬Ø¯ Ø´Ø±Ø§ÛŒØ·", network_count: "ØªØ¹Ø¯Ø§Ø¯ Ø´Ø¨Ú©Ù‡â€ŒØ§ÛŒâ€ŒÙ‡Ø§",
                pending_funds: "ÙˆØ¬ÙˆÙ‡ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±", miner_percentage: "Ø¯Ø±ØµØ¯ Ù…Ø§ÛŒÙ†Ø±",
                special_points: "Ø§Ù…ØªÛŒØ§Ø² ÙˆÛŒÚ˜Ù‡", left: "Ú†Ù¾", right: "Ø±Ø§Ø³Øª",
                you: "Ø´Ù…Ø§", special_reward: "Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡"
            },
            en: {
                dashboard: "Dashboard", register: "Register", miner: "Miner", actions: "Actions", admin: "Admin",
                connect_wallet: "Connect Wallet", pool_balance: "Pool Balance", miner_pool: "Miner Pool",
                special_pool: "Special Reward", entry_fee: "Entry Fee", user_info: "User Info",
                tree_title: "Your Tree Structure", register_label: "Upline Code", position: "Position",
                contribution: "Contribution (MATIC)", buy_miner: "Buy Miner Token", distribute: "Distribute Tokens",
                withdraw_pool: "Withdraw Main Pool", withdraw_special: "Withdraw Special", 
                last_pool_label: "Last Withdraw", special_label: "Next Special Withdraw", 
                registration_fee_text: "Register (300 MATIC)", miner_info: "Your Miner Info",
                pool_timer_title: "Time until next main-pool withdraw",
                token_price: "Token Price", miner_rewards: "Miner Rewards", is_miner: "Miner Status",
                last_buy_time: "Last Buy", progress: "Token Purchase Progress",
                eligible_count: "Eligible Users", network_count: "Networker Count",
                pending_funds: "Pending Funds", miner_percentage: "Miner Percentage",
                special_points: "Special Points", left: "Left", right: "Right",
                you: "You", special_reward: "Special Reward"
            }
        };

        let lang = 'fa';

        function t(key) {
            return translations[lang] && translations[lang][key] ? translations[lang][key] : key;
        }

        // ====== Constants ======
        const CONTRACT_ADDRESS = "0x7a7b06D49129B34976D07B3854d4D72D01588191";
        const POLYGON_CHAIN_ID = "0x89";
        const ENTRY_FEE = "300000000000000000000"; // 300 MATIC

        // ====== ABI (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±) ======
        const CONTRACT_ABI = [
            {"inputs":[{"internalType":"address","name":"owner","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},
            {"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"message","type":"string"}],"name":"DebugMessage","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"EntryFeeUpdated","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"string","name":"poolType","type":"string"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ManualWithdraw","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"contributor","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"MinerPoolContribution","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"}],"name":"MinerRemoved","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"MinerTokensBought","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"poolType","type":"string"}],"name":"NoEligibleUsers","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"upline","type":"address"},{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"bool","name":"placeOnLeft","type":"bool"}],"name":"Registered","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"}],"name":"UserMigrated","type":"event"},
            {"inputs":[],"name":"CYCLE_DURATION","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"ENTRY_FEE","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"MAX_CYCLE_BALANCES","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"MINER_BUY_INTERVAL","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"PTOKEN_CONTRACT","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"userId","type":"uint256"}],"name":"_getSpecialUserInfoForMigrateToNewFork","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"userAddress","type":"address"},{"internalType":"uint256","name":"leftCount","type":"uint256"},{"internalType":"uint256","name":"rightCount","type":"uint256"},{"internalType":"uint256","name":"saveLeft","type":"uint256"},{"internalType":"uint256","name":"saveRight","type":"uint256"},{"internalType":"uint256","name":"balanceCount","type":"uint256"},{"internalType":"address","name":"upline","type":"address"},{"internalType":"uint256","name":"specialBalanceCount","type":"uint256"},{"internalType":"uint256","name":"totalMinerRewards","type":"uint256"},{"internalType":"uint256","name":"entryPrice","type":"uint256"},{"internalType":"bool","name":"isMiner","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address[]","name":"usersToRemove","type":"address[]"}],"name":"batchRemoveMiners","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"buyMinerTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"contributeToMinerPool","outputs":[],"stateMutability":"payable","type":"function"},
            {"inputs":[],"name":"distributeMinerTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"eligiblePoolUserCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eligibleSpecialUserCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"getMinerStats","outputs":[{"internalType":"uint256","name":"checkedOutPaidCount","type":"uint256"},{"internalType":"uint256","name":"eligibleInProgressCount","type":"uint256"},{"internalType":"uint256","name":"totalRemain","type":"uint256"},{"internalType":"uint256","name":"networkerCount","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"percent","type":"uint256"}],"name":"getMinerStatsByPercent","outputs":[{"internalType":"uint256","name":"usersAbovePercent","type":"uint256"},{"internalType":"uint256","name":"totalRemaining","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"getSpecialPoolParticipants","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"getTokenPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"userId","type":"uint256"}],"name":"getUserDirects","outputs":[{"internalType":"uint256","name":"leftId","type":"uint256"},{"internalType":"uint256","name":"rightId","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserInfo","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"uplineId","type":"uint256"},{"internalType":"uint256","name":"leftCount","type":"uint256"},{"internalType":"uint256","name":"rightCount","type":"uint256"},{"internalType":"uint256","name":"saveLeft","type":"uint256"},{"internalType":"uint256","name":"saveRight","type":"uint256"},{"internalType":"uint256","name":"balanceCount","type":"uint256"},{"internalType":"uint256","name":"specialBalanceCount","type":"uint256"},{"internalType":"uint256","name":"totalMinerRewards","type":"uint256"},{"internalType":"uint256","name":"entryPrice","type":"uint256"},{"internalType":"bool","name":"isMiner","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint8","name":"day","type":"uint8"}],"name":"isCurrentTimeMatchToDay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"isPoolWithdrawable","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"lastMinerBuyTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"lastPoolWithdrawTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"minerPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"minerTokenPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"userWallet","type":"address"},{"internalType":"uint256","name":"uplineId","type":"uint256"},{"internalType":"address","name":"leftChildAddress","type":"address"},{"internalType":"address","name":"rightChildAddress","type":"address"},{"internalType":"uint256","name":"oldLeftCount","type":"uint256"},{"internalType":"uint256","name":"oldRightCount","type":"uint256"},{"internalType":"uint256","name":"oldLeftSave","type":"uint256"},{"internalType":"uint256","name":"oldRightSave","type":"uint256"}],"name":"mpu","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"ownerPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"pendingMinerFunds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"poolBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"poolPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"poolPointCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"uplineCode","type":"uint256"},{"internalType":"bool","name":"placeOnLeft","type":"bool"}],"name":"register","outputs":[],"stateMutability":"payable","type":"function"},
            {"inputs":[],"name":"specialPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"specialPointCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"specialRewardPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"totalUsers","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"updateEntryFee","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"userTokenPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"withdrawPool","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"withdrawSpecials","outputs":[],"stateMutability":"nonpayable","type":"function"}
        ];

        // ====== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ ======
        let provider, signer, contract, userAddress, isOwner = false;

        // ====== ØªÙ†Ø¸ÛŒÙ… Ø²Ø¨Ø§Ù† ======
        function setLanguage(newLang){
            lang = newLang;
            document.documentElement.setAttribute('dir', newLang === 'en' ? 'ltr' : 'rtl');

            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø²Ø¨Ø§Ù†
            document.getElementById('btn-fa').classList.toggle('active', newLang === 'fa');
            document.getElementById('btn-en').classList.toggle('active', newLang === 'en');

            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ØªÙˆÙ†
            updateAllTexts();
        }

        function updateAllTexts() {
            // ØªØ¨â€ŒÙ‡Ø§
            document.querySelectorAll('.tab-btn').forEach((btn, index) => {
                const texts = ['dashboard', 'register', 'miner', 'actions', 'admin'];
                if (texts[index]) btn.textContent = t(texts[index]);
            });

            // Ø¯Ú©Ù…Ù‡ Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„
            document.getElementById('connectBtn').textContent = t('connect_wallet');

            // Ø¹Ù†Ø§ÙˆÛŒÙ†
            document.getElementById('h-userinfo').textContent = 'ğŸ‘¤ ' + t('user_info');
            document.getElementById('h-tree').textContent = 'ğŸŒ³ ' + t('tree_title');
            document.getElementById('h-register').textContent = 'ğŸ“ ' + t('register');
            document.getElementById('h-miner').textContent = 'â›ï¸ ' + t('miner');
            document.getElementById('h-actions').textContent = 'ğŸ’¸ ' + t('actions');
            document.getElementById('h-admin').textContent = 'âš™ï¸ ' + t('admin');
            document.getElementById('h-minerinfo').textContent = 'ğŸ“Š ' + t('miner_info');

            // Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§
            document.getElementById('label-poolBalance').textContent = t('pool_balance');
            document.getElementById('label-minerPool').textContent = t('miner_pool');
            document.getElementById('label-specialPool').textContent = t('special_pool');
            document.getElementById('label-entryFee').textContent = t('entry_fee');
            document.getElementById('label-upline').textContent = t('register_label');
            document.getElementById('label-position').textContent = t('position');
            document.getElementById('label-contribution').textContent = t('contribution');
            document.getElementById('label-newFee').textContent = t('entry_fee') + ' (wei)';
            document.getElementById('label-addresses').textContent = t('pending_funds');

            // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
            document.getElementById('btn-register').textContent = t('registration_fee_text');
            document.getElementById('btn-buy').textContent = t('buy_miner');
            document.getElementById('btn-distrib').textContent = t('distribute');
            
            // ØªØ§ÛŒÙ…Ø±Ù‡Ø§
            document.getElementById('lastPoolLabel').textContent = t('last_pool_label') + ': -';
            document.getElementById('specialLabel').textContent = t('special_label');

            // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø±
            document.getElementById('label-tokenPrice').textContent = t('token_price');
            document.getElementById('label-minerRewards').textContent = t('miner_rewards');
            document.getElementById('label-isMiner').textContent = t('is_miner');
            document.getElementById('label-lastBuyTime').textContent = t('last_buy_time');
            document.getElementById('label-progress').textContent = t('progress');
            document.getElementById('label-eligibleCount').textContent = t('eligible_count');
            document.getElementById('label-networkCount').textContent = t('network_count');
            document.getElementById('label-pendingFunds').textContent = t('pending_funds');
            document.getElementById('label-minerPercentage').textContent = t('miner_percentage');

            // ÙÙˆØªØ±
            document.getElementById('footerText').textContent = 
                `SPS Network â€¢ ${lang === 'en' ? 'Contract Address' : 'Ø¢Ø¯Ø±Ø³ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯'}: ${CONTRACT_ADDRESS} â€¢ Polygon Mainnet`;
        }

        // ====== Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø±Ø®ØªÛŒ Ø¨Ø§ Ø§Ù…ØªÛŒØ§Ø² Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡ ======
        async function buildTreeHtml(nodeId, depth = 0, maxDepth = 3) {
            if (depth > maxDepth) return '';
            
            try {
                // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø±
                const userInfo = await contract._getSpecialUserInfoForMigrateToNewFork(nodeId);
                const directs = await contract.getUserDirects(nodeId);
                
                const leftId = directs[0] ? Number(directs[0]) : 0;
                const rightId = directs[1] ? Number(directs[1]) : 0;
                const leftCount = userInfo[2] ? Number(userInfo[2]) : 0;
                const rightCount = userInfo[3] ? Number(userInfo[3]) : 0;
                const specialBalanceCount = userInfo[8] ? Number(userInfo[8]) : 0;
                const isCurrentUser = userAddress && userInfo[1] && 
                    userInfo[1].toLowerCase() === userAddress.toLowerCase();

                // Ø§ÛŒØ¬Ø§Ø¯ HTML Ú¯Ø±Ù‡
                let html = `<div class="node ${isCurrentUser ? 'node-main' : ''} ${specialBalanceCount > 0 ? 'node-special' : ''}" 
                    data-id="${nodeId}" style="margin-${document.documentElement.dir === 'rtl' ? 'right' : 'left'}:${depth * 15}px">`;
                
                html += `<div class="node-info">`;
                html += `<div class="node-id">${isCurrentUser ? 'ğŸ‘¤ ' : ''}ID: ${nodeId} ${isCurrentUser ? `(${t('you')})` : ''}</div>`;
                html += `<div class="node-stats">`;
                html += `<span>${t('left')}: ${leftCount}</span>`;
                html += `<span>${t('right')}: ${rightCount}</span>`;
                if (specialBalanceCount > 0) {
                    html += `<span class="special-badge">${t('special_points')}: ${specialBalanceCount}</span>`;
                }
                html += `</div>`;
                html += `</div>`;
                
                if (leftId > 0 || rightId > 0) {
                    html += `<button class="toggle-btn" data-target="${nodeId}">${lang === 'en' ? '[toggle]' : '[Ø¨Ø§Ø²/Ø¨Ø³ØªÙ‡]'}</button>`;
                }
                
                html += `</div>`;
                
                // Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§
                if (leftId > 0 || rightId > 0) {
                    html += `<div class="children" id="children-${nodeId}" style="display:none">`;
                    if (leftId > 0) {
                        html += await buildTreeHtml(leftId, depth + 1, maxDepth);
                    }
                    if (rightId > 0) {
                        html += await buildTreeHtml(rightId, depth + 1, maxDepth);
                    }
                    html += `</div>`;
                }
                
                return html;
                
            } catch (e) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø³Ø§Ø®Øª Ø¯Ø±Ø®Øª:', e);
                return `<div class="node">âš ï¸ ${lang === 'en' ? 'Error loading node' : 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú¯Ø±Ù‡'} ${nodeId}</div>`;
            }
        }

        async function loadTreeStructure(userId) {
            const container = document.getElementById('treeContainer');
            container.innerHTML = `<div class="node node-main">ğŸ”„ ${lang === 'en' ? 'Loading tree...' : 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³Ø§Ø®ØªØ§Ø±...'}</div>`;
            
            try {
                const html = await buildTreeHtml(userId);
                container.innerHTML = html || `<div class="node node-main">ğŸ“­ ${lang === 'en' ? 'No network structure' : 'Ù‡ÛŒÚ† Ø³Ø§Ø®ØªØ§Ø± Ø´Ø¨Ú©Ù‡â€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯'}</div>`;
                
                // Ø§ÙØ²ÙˆØ¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ toggle
                container.querySelectorAll('.toggle-btn').forEach(btn => {
                    btn.onclick = () => {
                        const id = btn.getAttribute('data-target');
                        const el = document.getElementById('children-' + id);
                        if (el) {
                            el.style.display = el.style.display === 'none' ? 'block' : 'none';
                        }
                    };
                });
                
            } catch (err) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø®Øª:', err);
                container.innerHTML = `<div class="node node-main">âš ï¸ ${lang === 'en' ? 'Tree load error' : 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³Ø§Ø®ØªØ§Ø±'}</div>`;
            }
        }

        // ====== Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø± ======
        async function loadMinerDetails() {
            if (!contract || !userAddress) return;
            
            try {
                // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø®Ø´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø±
                document.getElementById('minerDetails').style.display = 'grid';
                document.getElementById('minerProgress').style.display = 'block';
                document.getElementById('minerStats').style.display = 'grid';
                
                // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø±
                const [
                    tokenPrice,
                    minerStats,
                    userInfo,
                    lastBuyTime,
                    eligibleCount,
                    networkerCount,
                    pendingFunds,
                    minerPercentage
                ] = await Promise.all([
                    contract.getTokenPrice().catch(() => 0),
                    contract.getMinerStats().catch(() => [0, 0, 0, 0]),
                    contract.getUserInfo(userAddress).catch(() => null),
                    contract.lastMinerBuyTime().catch(() => 0),
                    contract.eligiblePoolUserCount().catch(() => 0),
                    contract.getMinerStats().then(stats => stats[3]).catch(() => 0),
                    contract.pendingMinerFunds().catch(() => 0),
                    contract.minerPercentage().catch(() => 0)
                ]);
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                document.getElementById('tokenPrice').textContent = 
                    tokenPrice ? ethers.formatEther(tokenPrice).substring(0, 10) + ' MATIC' : '-';
                
                document.getElementById('minerRewards').textContent = 
                    userInfo ? ethers.formatEther(userInfo[8]).substring(0, 8) + ' MATIC' : '-';
                
                document.getElementById('isMiner').textContent = 
                    userInfo ? (userInfo[10] ? 'âœ… ' + (lang === 'en' ? 'Active' : 'ÙØ¹Ø§Ù„') : 'âŒ ' + (lang === 'en' ? 'Inactive' : 'ØºÛŒØ±ÙØ¹Ø§Ù„')) : '-';
                
                if (lastBuyTime > 0) {
                    const lastBuyDate = new Date(Number(lastBuyTime) * 1000);
                    document.getElementById('lastBuyTime').textContent = 
                        lastBuyDate.toLocaleDateString(lang === 'en' ? 'en-US' : 'fa-IR');
                } else {
                    document.getElementById('lastBuyTime').textContent = lang === 'en' ? 'Never' : 'Ù‡Ø±Ú¯Ø²';
                }
                
                // Ù¾ÛŒØ´Ø±ÙØª Ø®Ø±ÛŒØ¯ ØªÙˆÚ©Ù†
                if (minerStats && minerStats[2] > 0) {
                    const progress = Math.min(100, (Number(minerStats[0]) / Number(minerStats[2])) * 100);
                    document.getElementById('progressPercent').textContent = `${progress.toFixed(1)}%`;
                    document.getElementById('progressFill').style.width = `${progress}%`;
                }
                
                // Ø¢Ù…Ø§Ø± Ù…Ø§ÛŒÙ†Ø±
                document.getElementById('eligibleCount').textContent = Number(eligibleCount);
                document.getElementById('networkCount').textContent = Number(networkerCount);
                document.getElementById('pendingFunds').textContent = 
                    ethers.formatEther(pendingFunds).substring(0, 10) + ' MATIC';
                document.getElementById('minerPercentage').textContent = 
                    Number(minerPercentage) + '%';
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø±:', error);
            }
        }

        // ====== ØªÙˆØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±) ======
        function showStatus(message, type = 'info', targetId = 'userInfo') {
            const el = document.getElementById(targetId);
            el.className = `status ${type}`;
            el.innerHTML = message;
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'flex' : 'none';
        }

        function showTransactionLink(txHash, targetId) {
            const link = `https://polygonscan.com/tx/${txHash}`;
            document.getElementById(targetId).innerHTML = `
                <div class="status success">
                    âœ… ${lang === 'en' ? 'Transaction successful' : 'ØªØ±Ø§Ú©Ù†Ø´ Ù…ÙˆÙÙ‚'}
                    <div style="margin-top:8px"><a href="${link}" target="_blank" class="tx-link">
                        ${lang === 'en' ? 'View on Polygonscan' : 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø± Polygonscan'}
                    </a></div>
                </div>`;
        }

        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                showStatus('âŒ ' + t('connect_wallet') + (lang === 'en' ? ' not found' : ' ÛŒØ§ÙØª Ù†Ø´Ø¯'), 'error');
                return;
            }
            
            try {
                showLoading(true);
                showStatus('ğŸ”— ' + (lang === 'en' ? 'Connecting...' : 'Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„...'), 'info');
                
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                userAddress = accounts[0];
                
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                
                if (chainId !== POLYGON_CHAIN_ID) {
                    showStatus('ğŸ”„ ' + (lang === 'en' ? 'Switching to Polygon...' : 'ØªØºÛŒÛŒØ± Ø¨Ù‡ Ø´Ø¨Ú©Ù‡ Polygon...'), 'info');
                    
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: POLYGON_CHAIN_ID }]
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await window.ethereum.request({
                                method: 'wallet_addEthereumChain',
                                params: [{
                                    chainId: POLYGON_CHAIN_ID,
                                    chainName: 'Polygon Mainnet',
                                    nativeCurrency: { name: 'MATIC', symbol: 'MATIC', decimals: 18 },
                                    rpcUrls: ['https://polygon-rpc.com'],
                                    blockExplorerUrls: ['https://polygonscan.com']
                                }]
                            });
                        }
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 1200));
                }
                
                provider = new ethers.BrowserProvider(window.ethereum);
                signer = await provider.getSigner();
                contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                document.getElementById('connectArea').innerHTML = `
                    <div style="background:linear-gradient(90deg,#10b981,#34d399);color:#06281a;padding:10px;border-radius:8px;font-weight:700;display:flex;align-items:center;gap:8px">
                        <span>âœ…</span>
                        <div>
                            <div>${lang === 'en' ? 'Connected' : 'Ù…ØªØµÙ„ Ø´Ø¯'}</div>
                            <div style="font-size:11px">${userAddress.substring(0,6)}...${userAddress.substring(userAddress.length-4)}</div>
                        </div>
                    </div>
                `;
                
                await loadDashboard();
                showStatus('âœ… ' + (lang === 'en' ? 'Wallet connected successfully' : 'Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù…ØªØµÙ„ Ø´Ø¯'), 'success');
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§ÛŒÙ†Ø±
                await loadMinerDetails();
                
                window.ethereum.on('accountsChanged', () => location.reload());
                window.ethereum.on('chainChanged', () => location.reload());
                
            } catch (err) {
                showStatus('âŒ ' + err.message, 'error');
            } finally {
                showLoading(false);
            }
        }

        async function loadDashboard() {
            if (!contract) return;
            
            try {
                const [poolBalance, minerPool, specialPool, entryFee] = await Promise.all([
                    contract.poolBalance().catch(() => 0),
                    contract.minerTokenPool().catch(() => 0),
                    contract.specialRewardPool().catch(() => 0),
                    contract.ENTRY_FEE().catch(() => ENTRY_FEE)
                ]);
                
                document.getElementById('poolBalance').textContent = 
                    (ethers.formatEther(poolBalance).substring(0,12) || '0') + ' MATIC';
                document.getElementById('minerPool').textContent = 
                    (ethers.formatEther(minerPool).substring(0,12) || '0') + ' pToken';
                document.getElementById('specialPool').textContent = 
                    (ethers.formatEther(specialPool).substring(0,12) || '0') + ' MATIC';
                document.getElementById('entryFeeDisplay').textContent = 
                    (ethers.formatEther(entryFee) || '0') + ' MATIC';
                
                const userInfo = await contract.getUserInfo(userAddress).catch(() => null);
                if (userInfo) {
                    const userId = Number(userInfo[0]);
                    showStatus(`
                        <strong>ğŸ‘¤ ${lang === 'en' ? 'User' : 'Ú©Ø§Ø±Ø¨Ø±'} #${userId}</strong><br>
                        ğŸ“Š ${lang === 'en' ? 'Balance' : 'Ù…ÙˆØ¬ÙˆØ¯ÛŒ'}: ${userInfo[6]}<br>
                        ğŸ ${lang === 'en' ? 'Special Points' : 'Ø§Ù…ØªÛŒØ§Ø² ÙˆÛŒÚ˜Ù‡'}: ${userInfo[7]}<br>
                        â›ï¸ ${userInfo[10] ? 'âœ…' : 'âŒ'}<br>
                        ğŸ’° ${lang === 'en' ? 'Total Rewards' : 'Ù…Ø¬Ù…ÙˆØ¹ Ù¾Ø§Ø¯Ø§Ø´â€ŒÙ‡Ø§'}: ${ethers.formatEther(userInfo[8])} MATIC
                    `, 'success', 'userInfo');
                    
                    await loadTreeStructure(userId);
                    
                    const owner = await contract.owner().catch(() => null);
                    if (owner && owner.toLowerCase() === userAddress.toLowerCase()) {
                        isOwner = true;
                        document.getElementById('adminTab').style.display = 'block';
                    }
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ:', error);
            }
        }

        // ====== ØªÙˆØ§Ø¨Ø¹ ØªØ±Ø§Ú©Ù†Ø´ (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ù…Ù†Ø·Ù‚) ======
        async function register() {
            const uplineCode = document.getElementById('uplineCode').value;
            const position = document.getElementById('position').value === 'true';
            
            if (!uplineCode) {
                alert(lang === 'en' ? 'Please enter upline code' : 'Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ø¢Ù¾Ù„Ø§ÛŒÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            try {
                showLoading(true);
                const tx = await contract.register(uplineCode, position, { value: ENTRY_FEE });
                showTransactionLink(tx.hash, 'registerResult');
                await tx.wait();
                alert(lang === 'en' ? 'Registration successful!' : 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!');
                await loadDashboard();
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function contribute() {
            const amount = document.getElementById('contribution').value;
            if (!amount || amount <= 0) {
                alert(lang === 'en' ? 'Enter valid amount' : 'Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            try {
                showLoading(true);
                const tx = await contract.contributeToMinerPool({ value: ethers.parseEther(amount) });
                showTransactionLink(tx.hash, 'minerResult');
                await tx.wait();
                alert(lang === 'en' ? 'Contribution successful!' : 'Ù…Ø´Ø§Ø±Ú©Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!');
                await loadDashboard();
                await loadMinerDetails();
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function buyTokens() {
            try {
                showLoading(true);
                const tx = await contract.buyMinerTokens();
                showTransactionLink(tx.hash, 'minerResult');
                await tx.wait();
                alert(lang === 'en' ? 'Tokens purchased successfully!' : 'ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯!');
                await loadDashboard();
                await loadMinerDetails();
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function distribute() {
            try {
                showLoading(true);
                const tx = await contract.distributeMinerTokens();
                showTransactionLink(tx.hash, 'minerResult');
                await tx.wait();
                alert(lang === 'en' ? 'Tokens distributed successfully!' : 'ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙˆØ²ÛŒØ¹ Ø´Ø¯Ù†Ø¯!');
                await loadDashboard();
                await loadMinerDetails();
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function withdrawPool() {
            try {
                showLoading(true);
                const tx = await contract.withdrawPool();
                showTransactionLink(tx.hash, 'withdrawResult');
                await tx.wait();
                alert(lang === 'en' ? 'Withdrawal successful!' : 'Ø¨Ø±Ø¯Ø§Ø´Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!');
                await loadDashboard();
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function withdrawSpecial() {
            try {
                showLoading(true);
                const tx = await contract.withdrawSpecials();
                showTransactionLink(tx.hash, 'withdrawResult');
                await tx.wait();
                alert(lang === 'en' ? 'Special reward withdrawn!' : 'Ù¾Ø§Ø¯Ø§Ø´ ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø¯Ø§Ø´Øª Ø´Ø¯!');
                await loadDashboard();
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function updateFee() {
            if (!isOwner) {
                alert('âŒ ' + (lang === 'en' ? 'Permission denied: owner only' : 'Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø¯ Ø´Ø¯: ÙÙ‚Ø· Ù…Ø§Ù„Ú© Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯'));
                return;
            }
            
            const newFee = document.getElementById('newFee').value;
            if (!newFee) {
                alert(lang === 'en' ? 'Please enter new fee' : 'Ù„Ø·ÙØ§Ù‹ Ú©Ø§Ø±Ù…Ø²Ø¯ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            try {
                showLoading(true);
                const tx = await contract.updateEntryFee(newFee);
                showTransactionLink(tx.hash, 'adminResult');
                await tx.wait();
                alert(lang === 'en' ? 'Fee updated!' : 'Ú©Ø§Ø±Ù…Ø²Ø¯ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯!');
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function removeMiners() {
            if (!isOwner) {
                alert('âŒ ' + (lang === 'en' ? 'Permission denied: owner only' : 'Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø¯ Ø´Ø¯: ÙÙ‚Ø· Ù…Ø§Ù„Ú© Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯'));
                return;
            }
            
            const addressesText = document.getElementById('addresses').value;
            if (!addressesText) {
                alert(lang === 'en' ? 'Please enter addresses' : 'Ù„Ø·ÙØ§Ù‹ Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const addresses = addressesText.split(',').map(a => a.trim()).filter(a => ethers.isAddress(a));
            if (addresses.length === 0) {
                alert(lang === 'en' ? 'No valid addresses found' : 'Ù‡ÛŒÚ† Ø¢Ø¯Ø±Ø³ Ù…Ø¹ØªØ¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯');
                return;
            }
            
            try {
                showLoading(true);
                const tx = await contract.batchRemoveMiners(addresses);
                showTransactionLink(tx.hash, 'adminResult');
                await tx.wait();
                alert(lang === 'en' ? 'Miners removed!' : 'Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯!');
            } catch (error) {
                alert(lang === 'en' ? 'Error: ' : 'Ø®Ø·Ø§: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function showTab(tabName) {
            const tabs = ['dashboard', 'register', 'miner', 'actions', 'admin'];
            tabs.forEach(t => document.getElementById(t + 'Tab').style.display = 'none');
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName + 'Tab').style.display = 'block';
            event.target.classList.add('active');
            
            if (tabName === 'dashboard') {
                loadDashboard();
            } else if (tabName === 'miner') {
                loadMinerDetails();
            }
        }

        // ====== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ======
        window.onload = function() {
            // Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ AI
            createAIBackground();
            
            // ØªÙ†Ø¸ÛŒÙ… Ø²Ø¨Ø§Ù†
            document.getElementById('btn-fa').onclick = () => setLanguage('fa');
            document.getElementById('btn-en').onclick = () => setLanguage('en');
            
            // Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„
            document.getElementById('connectBtn').onclick = connectWallet;
            
            // Ø§ØªØµØ§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ú¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø¨Ù„Ø§Ù‹ Ù…ØªØµÙ„ Ø´Ø¯Ù‡
            if (typeof window.ethereum !== 'undefined') {
                window.ethereum.request({ method: 'eth_accounts' })
                    .then(accounts => {
                        if (accounts.length > 0) {
                            setTimeout(() => connectWallet(), 1000);
                        }
                    });
            }
        };
    </script>
</body>
</html>