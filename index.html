<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SPS Smart DApp â€” Polygon</title>

<!-- ethers.js UMD (v5) -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
  :root {
    --bg: #071022;
    --card: #0f1724;
    --accent: #7c3aed;
    --muted: #cbd5e1;
  }
  body{margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:#e6eef8;display:flex;align-items:center;justify-content:center;min-height:100vh}
  .wrap{width:100%;max-width:760px;padding:20px}
  .card{background:var(--card);border-radius:12px;padding:20px;box-shadow:0 8px 30px rgba(0,0,0,0.6)}
  h1{margin:0 0 12px 0;font-size:20px}
  .muted{color:var(--muted);font-size:13px}
  button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;margin-top:8px;width:100%}
  .row{display:flex;gap:10px;align-items:center;margin-top:10px}
  input, select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:#071322;color:#e6eef8}
  pre{background:#041220;padding:12px;border-radius:8px;overflow:auto;max-height:260px;font-size:13px;color:#dbeafe}
  .small{font-size:13px;color:#cbd5e1;margin-top:8px}
  a.mono{font-family:monospace;color:#9ae6b4}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>SPS Smart DApp (Polygon)</h1>
      <div class="muted">Contract: <a class="mono" id="contractAddress" href="https://polygonscan.com/address/0x7a7b06D49129B34976D07B3854d4D72D01588191" target="_blank" rel="noopener noreferrer">0x7a7b06D49129B34976D07B3854d4D72D01588191</a></div>

      <div style="margin-top:14px">
        <button id="connectBtn">ğŸ”— Ø§ØªØµØ§Ù„ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ (MetaMask / SafePal Browser)</button>
        <div class="small" id="connectedInfo"></div>
      </div>

      <hr style="margin:16px 0;opacity:0.08;border:none;height:1px;background:rgba(255,255,255,0.03)">

      <div>
        <h3 style="margin:0 0 8px 0">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… (register)</h3>
        <div class="row">
          <input id="uplineCode" placeholder="Upline code (number)">
          <select id="placeSide" style="width:160px">
            <option value="true">Left</option>
            <option value="false">Right</option>
          </select>
        </div>
        <button id="registerBtn">ğŸš€ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
        <div class="small">Ù…Ù‚Ø¯Ø§Ø± ENTRY_FEE Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øª Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.</div>
      </div>

      <hr style="margin:16px 0;opacity:0.08;border:none;height:1px;background:rgba(255,255,255,0.03)">

      <div>
        <h3 style="margin:0 0 8px 0">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± (getUserInfo)</h3>
        <input id="lookupWallet" placeholder="Wallet address (Ø®Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØµÙ„)">
        <button id="getUserInfoBtn">ğŸ” Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª</button>
        <pre id="userInfoBox">Ù†ØªÛŒØ¬Ù‡ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯...</pre>
      </div>

      <hr style="margin:16px 0;opacity:0.08;border:none;height:1px;background:rgba(255,255,255,0.03)">

      <div>
        <h3 style="margin:0 0 8px 0">Ø¹Ù…Ù„ÛŒØ§Øª Ø¯ÛŒÚ¯Ø±</h3>
        <div class="row">
          <button id="buyMinerTokensBtn" style="flex:1">ğŸ’  buyMinerTokens()</button>
          <button id="contributeMinerBtn" style="flex:1">â• contributeToMinerPool (payable)</button>
        </div>
        <div class="row">
          <button id="withdrawPoolBtn" style="flex:1">ğŸ’¸ withdrawPool()</button>
          <button id="withdrawSpecialsBtn" style="flex:1">ğŸ† withdrawSpecials()</button>
        </div>
      </div>

      <div class="small" style="margin-top:12px">
        Ù†Ú©ØªÙ‡: Ø¨Ø±Ø§ÛŒ Ø§ØªØµØ§Ù„ SafePal Ù…ÙˆØ¨Ø§ÛŒÙ„ØŒ Ø§Ø² Web3Modal/WalletConnect ÛŒØ§ Ù…Ø±ÙˆØ±Ú¯Ø± Ø¯Ø±ÙˆÙ†â€ŒØ¨Ø±Ù†Ø§Ù…Ù‡Ù” SafePal Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.  
        Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ ØªØ±Ø§Ú©Ù†Ø´ Ø¯Ø± mainnet Ù…Ù‚Ø¯Ø§Ø± Ú©Ù…ÛŒ Ø±Ø§ ØªØ³Øª Ú©Ù†ÛŒØ¯.
      </div>
    </div>
  </div>

<script>
/* ===========================
   ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ / ABI
   =========================== */

const CONTRACT_ADDRESS = "0x7a7b06D49129B34976D07B3854d4D72D01588191";

const CONTRACT_ABI = [{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"message","type":"string"}],"name":"DebugMessage","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"EntryFeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"string","name":"poolType","type":"string"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ManualWithdraw","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"contributor","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"MinerPoolContribution","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"}],"name":"MinerRemoved","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"MinerTokensBought","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"poolType","type":"string"}],"name":"NoEligibleUsers","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"upline","type":"address"},{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"bool","name":"placeOnLeft","type":"bool"}],"name":"Registered","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"}],"name":"UserMigrated","type":"event"},{"inputs":[],"name":"CYCLE_DURATION","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ENTRY_FEE","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MAX_CYCLE_BALANCES","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MINER_BUY_INTERVAL","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"PTOKEN_CONTRACT","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"userId","type":"uint256"}],"name":"_getSpecialUserInfoForMigrateToNewFork","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"userAddress","type":"address"},{"internalType":"uint256","name":"leftCount","type":"uint256"},{"internalType":"uint256","name":"rightCount","type":"uint256"},{"internalType":"uint256","name":"saveLeft","type":"uint256"},{"internalType":"uint256","name":"saveRight","type":"uint256"},{"internalType":"uint256","name":"balanceCount","type":"uint256"},{"internalType":"address","name":"upline","type":"address"},{"internalType":"uint256","name":"specialBalanceCount","type":"uint256"},{"internalType":"uint256","name":"totalMinerRewards","type":"uint256"},{"internalType":"uint256","name":"entryPrice","type":"uint256"},{"internalType":"bool","name":"isMiner","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"usersToRemove","type":"address[]"}],"name":"batchRemoveMiners","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"buyMinerTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"contributeToMinerPool","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"distributeMinerTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"eligiblePoolUserCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"eligibleSpecialUserCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMinerStats","outputs":[{"internalType":"uint256","name":"checkedOutPaidCount","type":"uint256"},{"internalType":"uint256","name":"eligibleInProgressCount","type":"uint256"},{"internalType":"uint256","name":"totalRemain","type":"uint256"},{"internalType":"uint256","name":"networkerCount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"percent","type":"uint256"}],"name":"getMinerStatsByPercent","outputs":[{"internalType":"uint256","name":"usersAbovePercent","type":"uint256"},{"internalType":"uint256","name":"totalRemaining","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getSpecialPoolParticipants","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTokenPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"userId","type":"uint256"}],"name":"getUserDirects","outputs":[{"internalType":"uint256","name":"leftId","type":"uint256"},{"internalType":"uint256","name":"rightId","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserInfo","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"uplineId","type":"uint256"},{"internalType":"uint256","name":"leftCount","type":"uint256"},{"internalType":"uint256","name":"rightCount","type":"uint256"},{"internalType":"uint256","name":"saveLeft","type":"uint256"},{"internalType":"uint256","name":"saveRight","type":"uint256"},{"internalType":"uint256","name":"balanceCount","type":"uint256"},{"internalType":"uint256","name":"specialBalanceCount","type":"uint256"},{"internalType":"uint256","name":"totalMinerRewards","type":"uint256"},{"internalType":"uint256","name":"entryPrice","type":"uint256"},{"internalType":"bool","name":"isMiner","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"day","type":"uint8"}],"name":"isCurrentTimeMatchToDay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"isPoolWithdrawable","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastMinerBuyTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastPoolWithdrawTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"minerPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"minerTokenPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address","name":"userWallet","type":"address"},{"internalType":"uint256","name":"uplineId","type":"uint256"},{"internalType":"address","name":"leftChildAddress","type":"address"},{"internalType":"address","name":"rightChildAddress","type":"address"},{"internalType":"uint256","name":"oldLeftCount","type":"uint256"},{"internalType":"uint256","name":"oldRightCount","type":"uint256"},{"internalType":"uint256","name":"oldLeftSave","type":"uint256"},{"internalType":"uint256","name":"oldRightSave","type":"uint256"}],"name":"mpu","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"ownerPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pendingMinerFunds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"poolBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"poolPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"poolPointCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"uplineCode","type":"uint256"},{"internalType":"bool","name":"placeOnLeft","type":"bool"}],"name":"register","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"specialPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"specialPointCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"specialRewardPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalUsers","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"updateEntryFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"userTokenPercentage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdrawPool","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawSpecials","outputs":[],"stateMutability":"nonpayable","type":"function"}];

 /* ===========================
    DApp runtime
    =========================== */

let provider, signer, contract;

const connectBtn = document.getElementById('connectBtn');
const registerBtn = document.getElementById('registerBtn');
const getUserInfoBtn = document.getElementById('getUserInfoBtn');
const userInfoBox = document.getElementById('userInfoBox');
const connectedInfo = document.getElementById('connectedInfo');
const buyMinerTokensBtn = document.getElementById('buyMinerTokensBtn');
const contributeMinerBtn = document.getElementById('contributeMinerBtn');
const withdrawPoolBtn = document.getElementById('withdrawPoolBtn');
const withdrawSpecialsBtn = document.getElementById('withdrawSpecialsBtn');

async function connectWallet() {
  try {
    if (!window.ethereum) {
      alert('Ú©ÛŒÙ Ù¾ÙˆÙ„ Web3 (MetaMask / SafePal) ÛŒØ§ÙØª Ù†Ø´Ø¯.');
      return;
    }
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send('eth_requestAccounts', []);
    signer = provider.getSigner();
    const addr = await signer.getAddress();
    connectedInfo.innerText = 'Ù…ØªØµÙ„: ' + addr;
    contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
    console.log('Connected to', addr);
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„: ' + (e && e.message));
  }
}

async function register() {
  try {
    if (!contract || !signer) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
    const uplineRaw = document.getElementById('uplineCode').value;
    const placeRaw = document.getElementById('placeSide').value;
    if (!uplineRaw) return alert('Ù„Ø·ÙØ§Ù‹ Upline code Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
    const upline = Number(uplineRaw);
    const placeOnLeft = placeRaw === 'true';

    // read ENTRY_FEE from contract
    const entryFee = await contract.ENTRY_FEE(); // BigNumber (wei)
    // send tx with value = entryFee
    const tx = await contract.register(upline, placeOnLeft, { value: entryFee });
    userInfoBox.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ ØªØ±Ø§Ú©Ù†Ø´...\n' + tx.hash;
    await tx.wait();
    userInfoBox.innerText = 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…ÙˆÙÙ‚ â€” TX: ' + tx.hash;
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…: ' + (e && e.message));
  }
}

async function getUserInfo() {
  try {
    if (!contract) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
    const lookup = document.getElementById('lookupWallet').value;
    let addr;
    if (!lookup) {
      if (!signer) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
      addr = await signer.getAddress();
    } else {
      addr = lookup;
    }
    const info = await contract.getUserInfo(addr);
    userInfoBox.innerText = JSON.stringify({
      id: info[0].toString(),
      uplineId: info[1].toString(),
      leftCount: info[2].toString(),
      rightCount: info[3].toString(),
      saveLeft: info[4].toString(),
      saveRight: info[5].toString(),
      balanceCount: info[6].toString(),
      specialBalanceCount: info[7].toString(),
      totalMinerRewards: info[8].toString(),
      entryPrice: info[9].toString(),
      isMiner: info[10]
    }, null, 2);
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª: ' + (e && e.message));
  }
}

async function buyMinerTokens() {
  try {
    if (!contract) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
    const tx = await contract.buyMinerTokens();
    userInfoBox.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„... ' + tx.hash;
    await tx.wait();
    userInfoBox.innerText = 'Ø®Ø±ÛŒØ¯ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯: ' + tx.hash;
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§: ' + (e && e.message));
  }
}

async function contributeToMinerPool() {
  try {
    if (!contract) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
    const amount = prompt('Ù…Ù‚Ø¯Ø§Ø± MATIC Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±ÛŒØ² Ø¨Ù‡ Miner Pool (Ù…Ø«Ø§Ù„: 0.1):', '0.1');
    if (amount === null) return;
    const value = ethers.utils.parseEther(String(amount));
    const tx = await contract.contributeToMinerPool({ value });
    userInfoBox.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„... ' + tx.hash;
    await tx.wait();
    userInfoBox.innerText = 'ÙˆØ§Ø±ÛŒØ² Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯: ' + tx.hash;
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§: ' + (e && e.message));
  }
}

async function withdrawPool() {
  try {
    if (!contract) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
    const tx = await contract.withdrawPool();
    userInfoBox.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„... ' + tx.hash;
    await tx.wait();
    userInfoBox.innerText = 'withdrawPool Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯: ' + tx.hash;
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§: ' + (e && e.message));
  }
}

async function withdrawSpecials() {
  try {
    if (!contract) return alert('Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙâ€ŒÙ¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯.');
    const tx = await contract.withdrawSpecials();
    userInfoBox.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„... ' + tx.hash;
    await tx.wait();
    userInfoBox.innerText = 'withdrawSpecials Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯: ' + tx.hash;
  } catch (e) {
    console.error(e);
    alert('Ø®Ø·Ø§: ' + (e && e.message));
  }
}

/* ============ wire UI ============ */
connectBtn.addEventListener('click', connectWallet);
registerBtn.addEventListener('click', register);
getUserInfoBtn.addEventListener('click', getUserInfo);
buyMinerTokensBtn.addEventListener('click', buyMinerTokens);
contributeMinerBtn.addEventListener('click', contributeToMinerPool);
withdrawPoolBtn.addEventListener('click', withdrawPool);
withdrawSpecialsBtn.addEventListener('click', withdrawSpecials);

</script>
</body>
</html>
