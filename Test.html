<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPS MATRIX ATOMIC</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0f172a;
            color: white;
            text-align: center;
            padding: 20px;
        }
        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            margin: 10px;
            cursor: pointer;
        }
        .wallet-info {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 500px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>ğŸš€ SPS MATRIX ATOMIC</h1>
    <p>Ø¯ÛŒâ€ŒØ§Ù¾ Ø§ØªÙ…ÛŒ - ØªØ³Øª Ø³Ø§Ø¯Ù‡</p>
    
    <button onclick="testWallet()">ØªØ³Øª Ú©ÛŒÙ Ù¾ÙˆÙ„</button>
    <button onclick="connectWallet()">Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„</button>
    
    <div id="walletPanel" class="wallet-info">
        <p id="walletAddress"></p>
        <p id="balance">Ù…ÙˆØ¬ÙˆØ¯ÛŒ: --</p>
    </div>
    
    <div id="result" style="margin-top: 20px;"></div>

    <script>
        // ØªØ§Ø¨Ø¹ Ø³Ø§Ø¯Ù‡ ØªØ³Øª Ú©ÛŒÙ Ù¾ÙˆÙ„
        function testWallet() {
            const result = document.getElementById('result');
            result.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            setTimeout(() => {
                let html = '<h3>Ù†ØªØ§ÛŒØ¬ ØªØ³Øª:</h3>';
                
                // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ providerÙ‡Ø§
                if (window.ethereum) {
                    html += '<p style="color:green">âœ… window.ethereum Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª</p>';
                } else {
                    html += '<p style="color:red">âŒ window.ethereum Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</p>';
                }
                
                if (window.safepalProvider) {
                    html += '<p style="color:green">âœ… window.safepalProvider Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª</p>';
                } else {
                    html += '<p style="color:red">âŒ window.safepalProvider Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</p>';
                }
                
                result.innerHTML = html;
            }, 500);
        }
        
        // ØªØ§Ø¨Ø¹ Ø§ØªØµØ§Ù„ Ø³Ø§Ø¯Ù‡
        async function connectWallet() {
            try {
                const result = document.getElementById('result');
                result.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„...';
                
                // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† provider
                const provider = window.ethereum || window.safepalProvider;
                
                if (!provider) {
                    result.innerHTML = '<p style="color:red">âŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>';
                    return;
                }
                
                // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§
                const accounts = await provider.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                if (accounts.length === 0) {
                    result.innerHTML = '<p style="color:red">âŒ Ù‡ÛŒÚ† Ø­Ø³Ø§Ø¨ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯</p>';
                    return;
                }
                
                // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                const walletAddress = accounts[0];
                document.getElementById('walletPanel').style.display = 'block';
                document.getElementById('walletAddress').textContent = 
                    'Ø¢Ø¯Ø±Ø³: ' + walletAddress.substring(0, 10) + '...';
                
                result.innerHTML = '<p style="color:green">âœ… Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚!</p>';
                
            } catch (error) {
                document.getElementById('result').innerHTML = 
                    '<p style="color:red">âŒ Ø®Ø·Ø§: ' + error.message + '</p>';
            }
        }
        
        // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ ØµÙØ­Ù‡
        window.addEventListener('load', function() {
            console.log('ØµÙØ­Ù‡ Ù„ÙˆØ¯ Ø´Ø¯');
            document.getElementById('result').innerHTML = 
                '<p>ØµÙØ­Ù‡ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª. Ø¯Ú©Ù…Ù‡ "ØªØ³Øª Ú©ÛŒÙ Ù¾ÙˆÙ„" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</p>';
        });
    </script>
</body>
</html>
